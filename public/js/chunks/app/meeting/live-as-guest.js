(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{"/MoV":function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return h}));var i=n("g6NE"),r=i.a.getters["config/configs"],o=i.a.getters["config/vars"],a=function(){return{timezone:r.system.timezone,defaultDateFormat:o.defaultDateFormat,defaultDateTimeFormat:o.defaultDateTimeFormat,serverDateFormat:o.serverDateFormat,serverDateTimeFormat:o.serverDateTimeFormat,calendarLocale:{lastDay:o.defaultDateFormat,sameDay:o.defaultTimeFormat,lastWeek:o.defaultDateFormat,sameElse:o.defaultDateFormat}}},s=function(e,t){var n=a(),i=moment(e,n.serverDateFormat);return e?(Array.isArray(e)&&(i=moment(e[0],e[1])),i.format(t||n.defaultDateFormat)):"INVALID DATE STRING"},c=function(e,t){var n=a(),i=moment(e,n.serverTimeFormat);return e?(Array.isArray(e)&&(i=moment(e[0],e[1])),i.format(t||n.defaultTimeFormat)):"INVALID TIME STRING"},d=function(e,t){var n=a(),i=moment(e,n.serverDateTimeFormat);return e?(Array.isArray(e)&&(i=moment(e[0],e[1])),i.format(t||n.defaultDateTimeFormat)):"INVALID DATE TIME STRING"},l=function(e,t){var n=a(),i=moment(e,n.serverDateTimeFormat);return e?(Array.isArray(e)&&(i=moment(e[0],e[1])),i.calendar(t||n.calendarLocale)):"INVALID DATE TIME STRING"},u=function(e,t,n){var i=a();if(!e)return"INVALID DATE STRING";var r=moment.utc(e,i.serverDateFormat);return"NOW"===e&&(r=moment.utc()),Array.isArray(e)&&(r=moment.utc(e[0],e[1])),r.tz(n||i.timezone).format(t||i.defaultDateFormat)},m=function(e,t,n){var i=a(),r=moment.utc("".concat(moment().format(i.serverDateFormat)," ").concat(e),i.serverTimeFormat);return e?(Array.isArray(e)&&(r=moment.utc(e[0],e[1])),r.tz(n||i.timezone).format(t||i.defaultTimeFormat)):"INVALID TIME STRING"},p=function(e,t,n){var i=a();if(!e)return"INVALID DATE TIME STRING";var r=moment.utc(e,i.serverDateTimeFormat);return"NOW"===e&&(r=moment.utc()),Array.isArray(e)&&(r=moment.utc(e[0],e[1])),r.tz(n||i.timezone).format(t||i.defaultDateTimeFormat)},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=a(),r=moment.utc(e,i.serverDateTimeFormat);if(!e)return"INVALID DATE TIME STRING";Array.isArray(e)&&(r=moment.utc(e[0],e[1]));var o=r.tz(n||i.timezone);return o=o.calendar(t||i.calendarLocale)}},0:function(e,t){},"0D4p":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("Vjiq"),r=n("vDqi"),o=n.n(r),a=n("eC5B"),s=n.n(a),c=n("g6NE"),d=function(){var e=c.a.getters["config/configs"],t=e.hasOwnProperty("pusher")?e.pusher:null;!window.Echo&&t&&t.pusherAppKey&&(t.debugMode?s.a.logToConsole=!0:s.a.logToConsole=!1,window.Echo=new i.a({broadcaster:"pusher",cluster:t.pusherAppCluster,encrypted:!0,key:t.pusherAppKey,authorizer:function(e,t){return{authorize:function(t,n){o.a.post("/api/broadcasting/auth",{socket_id:t,channel_name:e.name}).then((function(e){e&&e.data?n(!1,e.data):console.error("Invalid Data!")})).catch((function(e){n(!0,e)}))}}}}),window.EchoOpts={subscriptions:{}})}},"1TzJ":function(e,t,n){"use strict";var i=n("p46w"),r=n.n(i),o=n("7Cbv");!function(){var e=1,t=2;function n(n){var i="";switch(n){case e:i=window.name;break;case t:null!=(i=decodeURIComponent(r.a.get("my-application-browser-tab")))&&"undefined"!=i||(i="")}return i}function i(n,i){switch(n){case e:window.name=i;break;case t:r.a.set("my-application-browser-tab",i||"")}}function a(){var r=n(e)||Object(o.a)();i(e,r);var a=n(t),s=(""==a?null:JSON.parse(a))||null;if(null===s||s.timestamp<(new Date).getTime()-5e3||s.guid===r){var c=function(){var e={guid:r,timestamp:(new Date).getTime()};i(t,JSON.stringify(e))};return c(),setInterval(c,500),!1}return!0}window.isDuplicate=function(){return a()},window.addEventListener("beforeunload",(function(){0==a()&&i(t,"")}))}()},"8uEn":function(e,t,n){"use strict";function i(e,t){t||(t={});var n=t.max||100,i=t.boxCount||50,r=t.boxCountRed||5,o=t.boxCountYellow||5,a=t.boxGapFraction||0,s=t.jitter||.02,c=t.width||"auto",d=e.width,l=e.height,u=0,m=e.parentElement,p=e.nextElementSibling||e.previousElementSibling;"auto"!==c&&"parent"!==c||!m.clientWidth?"sibling"===c&&p.clientWidth&&(d=p.clientWidth,e.width=d):(d=m.clientWidth,e.width=d);var h=d/(i+(i+1)*a),f=h*a,v=l-2*f,g=(l-v)/2,C=e.getContext("2d");function b(e,t){return e>i-r?y(e,t)?"rgba(255,47,30,0.9)":"rgba(64,12,8,0.9)":e>i-r-o?y(e,t)?"rgba(255,215,5,0.9)":"rgba(64,53,0,0.9)":y(e,t)?"rgba(53,255,30,0.9)":"rgba(13,64,8,0.9)"}function y(e,t){return e<=Math.ceil(t/n*i)}!function t(){var r=parseInt(e.dataset.val,10);if(u<=r?u+=(r-u)/5:u-=(u-r)/5,s>0&&u>0){var o=Math.random()*s*n;Math.random()>.5&&(o=-o),u+=o}u<0&&(u=0),C.save(),C.beginPath(),C.rect(0,0,d,l),C.fillStyle="rgb(32,32,32)",C.fill(),C.restore(),function(e,t){e.save(),e.translate(g,f);for(var n=0;n<i;n++){var r=(o=n,Math.abs(o)+1);e.beginPath(),e.rect(0,0,h,v),e.fillStyle=b(r,t),e.fill(),e.translate(h+f,0)}var o;e.restore()}(C,u),requestAnimationFrame(t)}()}n.d(t,"a",(function(){return i}))},BcCH:function(e,t,n){"use strict";var i=n("XuX8"),r=new(n.n(i).a);t.a=r},U8Zb:function(e,t,n){"use strict";n.r(t);var i=n("L2JU"),r=n("gFX4"),o=n.n(r),a=n("zWga"),s=n.n(a),c=(n("qe5e"),n("mpN2"),n("x18S")),d=n.n(c),l=(n("l4sq"),n("k7+O")),u=n.n(l),m=n("0D4p"),p=n("akQX"),h=n("V0LQ"),f=n("lUM2"),v=n("PCDP"),g=n("/MoV"),C=n("8uEn"),b=(n("1TzJ"),n("kogc"));function y(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=document.createElement("script");P.setAttribute("src","/js/EBML.js"),document.head.appendChild(P),window.io=o.a,window.hark=d.a;var k={components:{RTCMultiConnection:s.a},data:function(){return{uuid:null,entity:null,isLoading:!1,prevRoute:null,fullScreenItemId:null,meetingRoomId:null,initUrl:"meetings",fallBackRoute:"login",newMessages:!1,roomIdAlive:!1,showFlipClock:!0,duplicateTab:!1,fullScreenInOn:!1,permissionRejected:!1,needStreamAddOrReplace:!1,membersLive:[],videoList:[],mediaConfigFormData:{},mediaConfigurations:{selectedAudioInput:null,selectedAudioOutput:null,selectedVideoInput:null,activeAudioInput:null,activeVideoInput:null,activeFacingMode:null,selectedResolution:"Auto",facingMode:"auto",frameRate:"auto",bandwidth:{audio:"auto",video:"auto",screen:"auto",audioMin:6,videoMin:100,screenMin:300},recording:{type:"video",mimeType:"video/webm",timeSlice:1e3,disableLogs:!1}},audioBandwidthOpts:[{uuid:"auto",label:"Auto"},{uuid:64,label:"64 kbps"},{uuid:128,label:"128 kbps"},{uuid:256,label:"256 kbps"},{uuid:510,label:"512 kbps"}],videoBandwidthOpts:[{uuid:"auto",label:"Auto"},{uuid:128,label:"128 kbps"},{uuid:256,label:"256 kbps"},{uuid:512,label:"512 kbps"},{uuid:1024,label:"1 mbps"},{uuid:2e3,label:"2 mbps"}],screenBandwidthOpts:[{uuid:"auto",label:"Auto"},{uuid:512,label:"512 kbps"},{uuid:1024,label:"1 mbps"},{uuid:2048,label:"2 mbps"},{uuid:3e3,label:"3 mbps"},{uuid:4e3,label:"4 mbps"}],mediaDevices:{audioInput:[{uuid:"auto",name:"Auto"}],audioOutput:[{uuid:"auto",name:"Auto"}],videoInput:[{uuid:"auto",name:"Auto"}],resolutions:[{label:"Auto",constraints:{}},{label:"240p",constraints:{width:{max:426,ideal:426},height:{max:240,ideal:240}}},{label:"360p",constraints:{width:{max:640,ideal:640},height:{max:360,ideal:360}}},{label:"720p",constraints:{width:{max:1280,ideal:1280},height:{max:720,ideal:720}}},{label:"1080p",constraints:{width:{max:1920,ideal:1920},height:{max:1080,ideal:1080}}},{label:"4K",constraints:{width:{max:4096,ideal:4096},height:{max:2160,ideal:2160}}}],facingModes:[{uuid:"auto",label:"Auto"},{uuid:"user",label:"User"},{uuid:"environment",label:"Environment"}],frameRates:[{uuid:"auto",label:"Auto"},{uuid:30,label:"30 fps"},{uuid:60,label:"60 fps"}]},socketURL:"aHR0cHM6Ly9zaWduYWwua29kZW1pbnQuaW46OTAwMS8=",rtcmConnection:null,localVideo:null,localScreenStreamid:null,localWhiteboardStreamid:null,localGreenRoomStream:null,audioConstraints:{},videoConstraints:{},pageConfigs:{hasAgenda:!0,enableChat:!0,enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!0,showDeviceConfig:!0,enableScreenSharing:!0,enableRecording:!0,enableHandGesture:!0,enableWhiteboard:!1,footerAutoHide:!1,disableScroll:!1,speechDetection:!1,muteParticipantsOnStart:!1,allowJoiningWithoutDevices:!1,enableFileSharing:!0,enableLinkSharing:!0,enableSnapshot:!1,anyoneCanTakeSnapshot:!1,enableSnapshotAlert:!1,snapshotAlertToUserOnly:!1,snapshotAlertToModerators:!1,askHostBeforeJoining:!1,preferRearCameraFirst:!1,layout:"fullpage",lastLayout:"fullpage",maxParticipantCount:1e3},meetingRulesHost:{session:{audio:!1,video:!1,screen:!1,data:!1,oneway:!1},mediaConstraints:{audio:!1,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},autoCloseEntireSession:!1},meetingRulesGuest:{session:{audio:!1,video:!1,screen:!1,data:!1,oneway:!1},mediaConstraints:{audio:!1,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},autoCloseEntireSession:!1},snoozeOpts:[{uuid:5,name:5,type:"m"},{uuid:10,name:10,type:"m"},{uuid:15,name:15,type:"m"},{uuid:30,name:30,type:"m"},{uuid:60,name:1,type:"h"}],isHandUp:!1,recording:!1,recorded:!1,recordingPaused:!1,recordingDuration:null,showDevicesModal:!1,showFileSharing:!1,showWhiteboard:!1,showAgenda:!0,fileSharingConnection:null,canvasDesigner:null,micVolumeActivity:20,meetingRoomNotFound:!1,profile:{uuid:"",username:"",name:""}}},computed:T(T({},Object(i.c)("config",["configs","uiConfigs","vars"])),{},{user:function(){return this.profile},hasVideos:function(){return this.videoList&&this.videoList.length>0?this.videoList.length:0},hasVideosClasses:function(){if(!this.hasVideos)return"has-no-video";var e="has-videos "+(this.pageConfigs.disableScroll?"disable-scroll ":"")+"has-".concat(this.hasVideos,"-videos "),t=this.hasVideos>15?4:this.hasVideos>8?3:this.hasVideos>3?2:1,n=this.hasVideos>20?6:16===this.hasVideos?4:this.hasVideos>12?5:this.hasVideos>9?4:9===this.hasVideos?3:this.hasVideos>6?4:this.hasVideos>4?3:4===this.hasVideos?2:this.hasVideos;return e+(this.hasVideos>20?"has-gt-20-videos":this.hasVideos>12?"has-gt-12-videos":this.hasVideos>4?"has-gt-4-videos":this.hasVideos>1?"has-2-3-videos":"has-1-video")+" has-".concat(t,"-rows has-").concat(n,"-per-row")},liveMembersCount:function(){return this.membersLive.length-1},startDateTimeIsFuture:function(){var e=this.entity&&this.showFlipClock&&this.isStartDateTimeInFuture();return e?this.startCountDown():window.countdownInterval&&clearInterval(window.countdownInterval),e},enableLogs:function(){return this.rtcmConnection&&this.rtcmConnection.enableLogs}}),watch:{liveMembersCount:function(e,t){window.isLiveMeetingDestroyed||e===t||this.meetingRoomCreated(this.entity)}},methods:T(T(T({},Object(i.b)("config",["GetConfig","SetUiConfig"])),Object(i.b)("common",["Init","Get","Custom","GetPreRequisite"])),{},{shareURL:function(){var e=this;if(this.entity){this.$gaEvent("engagement","shareURL","Shown");var t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");t+=this.entity.identifier?"/m/".concat(this.entity.identifier):"/app/live/meetings/".concat(this.entity.uuid);var n=this.entity.identifier?"".concat($t("meeting.meeting_code"),': <strong class="ml-2"> ').concat(this.entity.identifier,"</strong>"):null;Object(p.d)({title:$t("meeting.user_inviting_msg",{attribute:this.user.name}),alertTitle:n,alertHtml:"".concat($t("misc.share_alert.text"),"<br>")+"<small class='text-muted'>".concat(t,"</small><br>"),url:t},(function(){e.$gaEvent("engagement","shareURL","Copied"),e.$toasted.success($t("meeting.url_has_been_copied"),e.$toastConfig)}))}},isStartDateTimeInFuture:function(){return this.entity&&this.entity.startDateTime&&moment(this.entity.startDateTime,this.vars.serverDateTimeFormat).isAfter(moment())},startCountDown:function(){var e=this;window.countdownInterval&&clearInterval(window.countdownInterval),window.countdownInterval=window.setInterval((function(){e.isStartDateTimeInFuture()?e.showFlipClock=!0:(e.showFlipClock&&!document.hasFocus()&&Object(p.a)(),e.showFlipClock=!1)}),1e3)},takeSnapshotOfStream:function(e,t){var n=this;if(this.pageConfigs.enableSnapshot&&this.pageConfigs.anyoneCanTakeSnapshot){this.$gaEvent("engagement","takeSnapshot");var i=this.takeSnapshot(this.$refs.videos[t],!e.disableMirror),r="".concat(e.extra.username," stream by ").concat(this.username);this.Custom({url:"/".concat(this.initUrl,"/").concat(this.uuid,"/snapshots"),method:"post",data:{image:i,name:r}}).then((function(e){n.$toasted.info($t("meeting.snapshot_taken"),T(T({},n.$toastConfig.info),{},{duration:1e4,icon:{name:"fa-download"},action:{text:"View / Download",href:e.fullUrl,target:"_blank"}}))})).catch((function(e){n.isLoading=!1,formUtil.handleErrors(e)})),this.informAboutSnapshot(e),Object(p.c)()}},takeSnapshot:function(e,t){var n=document.createElement("canvas");n.width=2*(e.videoWidth||e.clientWidth),n.height=2*(e.videoHeight||e.clientHeight);var i=n.getContext("2d");return this.configs.meeting&&this.configs.meeting.mirroredVideo&&t&&(i.translate(n.width,0),i.scale(-1,1)),i.drawImage(e,0,0,n.width,n.height),n.toDataURL("image/png")},informAboutSnapshot:function(e){this.pageConfigs.enableSnapshotAlert&&this.emitSocketEvents("snapshotTaken",{byUser:this.user,ofUser:e.extra,item:e})},toggleHandUp:function(){var e=this;this.$gaEvent("engagement","toggleHandUp"),window.lowerHandTimer&&clearTimeout(window.lowerHandTimer);var t=this.$refs.videos.find((function(t){return t.id===e.localVideo.id})),n=this.videoList.findIndex((function(t){return t.id===e.localVideo.id}));if(t&&t.srcObject){var i=t.srcObject;this.isHandUp=!this.isHandUp,this.videoList[n].isHandUp=this.isHandUp,this.emitSocketEvents("remoteHandToggled",{isHandUp:this.isHandUp,streamid:i.streamid}),this.isHandUp&&(window.lowerHandTimer=setTimeout((function(){e.toggleHandUp()}),3e4)),this.rtcmConnection.extra.isHandUp=this.isHandUp,this.rtcmConnection.updateExtraData()}else this.localVideo=null},toggleAudio:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.$refs.videos.find((function(e){return e.id===t.localVideo.id})),r=this.videoList.findIndex((function(e){return e.id===t.localVideo.id}));if(i&&i.srcObject){var o=i.srcObject,a=o.getAudioTracks();a.forEach((function(e){t.pageConfigs.enableAudio||n?(t.pageConfigs.enableAudio=!1,e.enabled=!1,t.videoList[r].audioMuted=!0):(t.pageConfigs.enableAudio=!0,e.enabled=!0,t.videoList[r].audioMuted=!0)})),this.emitSocketEvents("remoteMutedUnmuted",{audioEnabled:this.pageConfigs.enableAudio,streamid:o.streamid}),this.rtcmConnection.extra.audioMuted=!this.pageConfigs.enableAudio,this.rtcmConnection.updateExtraData()}else this.localVideo=null},toggleVideo:function(){var e=this,t=this.$refs.videos.find((function(t){return t.id===e.localVideo.id})),n=this.videoList.findIndex((function(t){return t.id===e.localVideo.id}));if(t&&t.srcObject){var i=t.srcObject;i.getVideoTracks().forEach((function(t){e.pageConfigs.enableVideo?(e.pageConfigs.enableVideo=!1,t.enabled=!1,e.videoList[n].videoMuted=!0):(e.pageConfigs.enableVideo=!0,t.enabled=!0,e.videoList[n].videoMuted=!1)})),this.emitSocketEvents("remoteMutedUnmuted",{videoEnabled:this.pageConfigs.enableVideo,streamid:i.streamid}),this.rtcmConnection.extra.videoMuted=!this.pageConfigs.enableVideo,this.rtcmConnection.updateExtraData()}else this.localVideo=null},toggleRemoteAudio:function(e,t){e.muted?(this.videoList[t].muted=!1,this.$refs.videos[t].muted=!1):(this.videoList[t].muted=!0,this.$refs.videos[t].muted=!0)},toggleRemoteAudioSource:function(e,t){this.emitSocketEvents("muteUnmuteRemote",e)},toggleEleFullScreen:function(e,t){var n=this,i=this.$refs.videoListEle;this.fullScreenItemId=e.id,this.$fullscreen.toggle(i,{wrap:!1,callback:function(e){n.fullScreenInOn=e}})},toggleFullScreen:function(e){u.a.isEnabled&&(e?u.a.request():u.a.exit())},toggleFooterAutoHide:function(){this.pageConfigs.footerAutoHide=!this.pageConfigs.footerAutoHide,this.$gaEvent("engagement","toggleFooterAutoHide")},toggleLayout:function(e){this.pageConfigs.layout=e||this.pageConfigs.layout,this.pageConfigs.disableScroll="grid"===this.pageConfigs.layout||(this.entity.config&&this.entity.config.hasOwnProperty("disableScroll")?this.entity.config.disableScroll:this.pageConfigs.disableScroll),this.$gaEvent("engagement","toggleLayout",e)},toggleFileSharing:function(){this.showFileSharing=!this.showFileSharing,this.$gaEvent("engagement","toggleFileSharing")},toggleAgenda:function(){this.showAgenda=!this.showAgenda,this.$gaEvent("engagement","toggleAgenda")},toggleWhiteboard:function(){this.$gaEvent("engagement","toggleWhiteboard"),this.showWhiteboard?(this.pageConfigs.layout=this.pageConfigs.lastLayout,this.showWhiteboard=!1):(this.canvasDesigner||this.initWhiteboard(),this.pageConfigs.lastLayout=this.pageConfigs.layout,this.pageConfigs.layout="presentation",this.showWhiteboard=!0)},changeFocus:function(e){e.local||this.videoList.forEach((function(t){t.maximized=t.id===e.id}))},kickRemoteUser:function(e,t){var n=this;formUtil.confirmAction().then((function(t){if(t.value){var i=n.$refs.videos.find((function(t){return t.id===e.id}));if(i&&i.srcObject){var r=i.srcObject;n.rtcmConnection.removeStream(r.streamid),n.emitSocketEvents("banAttendee",e),n.Custom({url:"/".concat(n.initUrl,"/").concat(n.uuid,"/invitees/").concat(e.extra.uuid,"/block"),method:"post"}).then((function(e){n.$toasted.success(e.message,n.$toastConfig)})).catch((function(e){formUtil.handleErrors(e)}))}}else t.dismiss,b.c.DismissReason.cancel}))},switchCamera:function(){this.mediaConfigurations.facingMode="user"===this.mediaConfigurations.facingMode?"environment":"user",this.applyMediaConstraints()},stopStream:function(e){var t=this.$refs.videos.find((function(t){return t.id===e.id}));t&&t.srcObject&&t.srcObject.getTracks().forEach((function(e){return e.stop()}))},afterJoiningChannel:function(e){this.membersLive=e},newMemberJoining:function(e){this.membersLive.push(e)},memberLeaving:function(e){this.membersLive=this.membersLive.filter((function(t){return t.uuid!==e.uuid}))},meetingStatusChanged:function(e){if(e.uuid===this.entity.uuid){if(this.entity.status===e.status&&!e.delayed)return;this.entity.status=e.status,this.entity.startDateTime=g.e(e.startDateTime,this.vars.serverDateTimeFormat);var t=e.status;"scheduled"===t&&e.delayed&&(t="delayed");this.$toasted.success($t({live:"meeting.is_live_now",delayed:"meeting.meeting_delayed",cancelled:"meeting.meeting_cancelled",ended:"meeting.meeting_ended"}[t]),this.$toastConfig)}},gotNewMessage:function(){this.pageConfigs.enableChat&&this.configs.chat&&this.configs.chat.enabled&&(this.pageConfigs.showChat&&!this.fullScreenInOn||(this.newMessages=!0,Object(p.a)()))},meetingRoomCreated:function(e){var t=this;this.entity.roomId=e.roomId,this.initMediaAndRtcmConnection(),this.rtcmConnection.checkPresence(this.entity.roomId,(function(e,n){t.roomIdAlive=!!e,!0===e&&!0===t.meetingRoomNotFound&&(t.meetingRoomNotFound=!1,t.getOnline())}))},banAttendee:function(e){this.enableLogs&&console.log(e);var t=this.$refs.videos.find((function(t){return t.id===e.id}));if(t&&t.srcObject){var n=t.srcObject;this.rtcmConnection.removeStream(n.streamid)}e.uuid===this.userUuid&&(this.closeConnectionAndStream(),this.getInitialData()),this.$toasted.info($t("meeting.ban_notification"),this.$toastConfig.info)},streamRemoved:function(e){this.rtcmConnection&&e.id&&this.rtcmConnection.removeStream(e.id),this.rtcmOnStreamEnded(e)},meetingEnded:function(e){this.closeConnectionAndStream(),this.getInitialData()},joinChannel:function(){window.Echo&&(this.entity.isPam?window.meetingChannel=window.Echo.channel("MeetingGuest.".concat(this.uuid)):(window.meetingChannel=window.Echo.join("Meeting.".concat(this.uuid)),window.meetingChannel.here(this.afterJoiningChannel).joining(this.newMemberJoining).leaving(this.memberLeaving)),window.meetingChannel.listen("MeetingStatusChanged",this.meetingStatusChanged).listen("NewMessage",this.gotNewMessage).listen("MeetingRoomCreated",this.meetingRoomCreated).listen("PublicMeetingRoomCreated",this.meetingRoomCreated))},emitSocketEvents:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.rtcmConnection&&this.rtcmConnection.socket&&e&&(this.enableLogs&&console.log("Emitting on Socket: ",e),this.rtcmConnection.socket.emit("Whisper",{event:e,data:t}))},rtcmOnOpen:function(e){var t=this;this.canvasDesigner&&this.canvasDesigner.pointsLength<=0&&setTimeout((function(){t.rtcmConnection.send("sync-canvas-points")}),1e3),this.canvasDesigner&&this.rtcmConnection.isInitiator&&setTimeout((function(){this.canvasDesigner.renderStream()}),1e3)},rtcmOnClose:function(e){},rtcmOnMessage:function(e){"sync-canvas-points"!==e.data?this.canvasDesigner.syncData(e.data):this.canvasDesigner.sync()},rtcmOnUserStatusChanged:function(e){var t=this,n=this.rtcmConnection.userid;this.enableLogs&&(console.log("On rtcmOnUserStatusChanged - event : ",e),console.log("On rtcmOnUserStatusChanged - localUserId : ",n));var i=this.videoList.filter((function(t){return t.id===e.userid||t.streamUserId===e.userid||e.extra&&t.uuid===e.extra.uuid}));e&&"online"===e.status?i&&i.length?i.forEach((function(n){if(n.username!==e.extra.username){var i=t.videoList.findIndex((function(e){return e.uuid===n.uuid}));t.videoList[i].username=e.extra.username,t.videoList[i].name=e.extra.name,t.videoList[i].extra&&(t.videoList[i].extra.username=e.extra.username,t.videoList[i].extra.name=e.extra.name)}})):e.extra&&e.extra.hasOwnProperty("username")&&e.extra.username&&function(e){var i=e.userid,r=e.userid===n?"local":"remote";if(t.rtcmConnection.isInitiator||t.entity.canModerate||"local"===r||"live_class"!==t.entity.type.uuid&&"webinar"!==t.entity.type.uuid){var o=t.videoList.find((function(t){return t.id===e.streamid}));if(t.videoList.length>1&&t.recheckLiveParticipants(null),void 0===o){var a=T(T({id:i,streamUserId:e.userid,muted:!0},e.extra),{},{extra:e.extra,maximized:!1,local:"local"===r,screen:!1,status:!0,hasAudio:!1,hasVideo:!1,hasStream:!1,speaking:!1});t.videoList.push(a)}t.isLoading=!1}}(e):i&&i.length&&i.forEach((function(e){t.rtcmConnection.removeStream(e.id),t.recheckLiveParticipants(T(T({},e),{},{streamid:e.id})),t.autoSetVideoMaximized()}))},rtcmOnLeave:function(e){this.enableLogs&&console.log("On rtcmOnLeave - event : ",e)},rtcmOnSpeaking:function(e){var t=this,n=this.videoList.findIndex((function(t){return t.id===e.streamid}));window.onSilenceTimeoutObj["index"+n]&&clearTimeout(window.onSilenceTimeoutObj["index"+n]),this.videoList[n]&&(this.videoList[n].speaking=!0),window.onSilenceTimeoutObj["index"+n]=setTimeout((function(){t.videoList[n]&&(t.videoList[n].speaking=!1)}),5e3)},rtcmOnSilence:function(e){var t=this,n=this.videoList.findIndex((function(t){return t.id===e.streamid}));window.onSilenceTimeoutObj["index"+n]&&clearTimeout(window.onSilenceTimeoutObj["index"+n]),window.onSilenceTimeoutObj["index"+n]=setTimeout((function(){t.videoList[n]&&(t.videoList[n].speaking=!1)}),2e3)},rtcmOnVolumeChange:function(e){},rtcmOnStream:function(e){var t=this;if(this.enableLogs&&console.log("On Stream: ",e),this.rtcmConnection.isInitiator||this.entity.canModerate||"local"===e.type||"live_class"!==this.entity.type.uuid&&"webinar"!==this.entity.type.uuid||e.extra.isInitiator){var n=e.streamid,i=this.videoList.findIndex((function(t){return t.id===e.streamid||t.id===e.userid})),r=e.stream.idInstance?JSON.parse(e.stream.idInstance):e.stream,o=!(r.isAudio||r.audio||r.isVideo||r.video||r.isScreen||r.screen)&&e.extra.hasWhiteboard;if(r.isScreen&&"local"===e.type)this.localScreenStreamid=e.streamid,e.stream.getTracks().forEach((function(e){e.addEventListener("ended",t.stopSharingScreen)}));else o&&"local"===e.type&&(this.localWhiteboardStreamid=e.streamid);this.videoList.length>1&&this.recheckLiveParticipants(null);var a=T(T({id:n,streamUserId:e.userid,muted:"local"===e.type},e.extra),{},{extra:e.extra,maximized:"local"===e.type&&!r.isScreen&&!o,local:"local"===e.type,screen:this.localScreenStreamid===n,whiteboard:o,status:!0,hasAudio:r.isAudio||r.audio,hasVideo:r.isVideo||r.video||r.isScreen||o||r.screen,hasStream:!0,speaking:!1});if((r.isScreen||o)&&(a.videoMuted=!1),-1===i?"local"===e.type&&this.localScreenStreamid!==a.id&&this.localWhiteboardStreamid!==a.id?this.localVideo&&this.needStreamAddOrReplace?a.id=n=this.localVideo.id:(this.localVideo=a,this.videoList.push(a)):this.videoList.push(a):-1===i||this.videoList[i].hasStream||("local"===e.type&&this.localScreenStreamid!==a.id&&this.localWhiteboardStreamid!==a.id?this.localVideo&&this.needStreamAddOrReplace?a.id=n=this.localVideo.id:(this.localVideo=a,this.videoList[i]=Object.assign({},this.videoList[i],a)):this.videoList[i]=Object.assign({},this.videoList[i],a)),this.autoSetVideoMaximized(),this.pageConfigs.enableRecording){var s=this.rtcmConnection.recorder;if(s){var c=s.getInternalRecorder();this.recording&&c&&c.addStreams(e.stream)}}setTimeout((function(){t.enableLogs&&(console.log("$refs : ",t.$refs),console.log("$refs.videos : ",t.$refs.videos));for(var i=0,a=t.$refs.videos.length;i<a;i++)if(t.$refs.videos[i].id===n||t.$refs.videos[i].id===e.userid){t.$refs.videos[i].srcObject=e.stream;break}"local"===e.type&&t.applyOnStartConfigs(),setTimeout((function(){!t.pageConfigs.speechDetection||o||r.isScreen||t.initHark({stream:e.stream,streamedObject:e,connection:t.rtcmConnection})}),1e3)}),500),this.isLoading=!1}},rtcmOnStreamEnded:function(e){this.recheckLiveParticipants(e),this.autoSetVideoMaximized()},rtcmOnMediaError:function(e){var t=this;this.isLoading=!1,window.currentUserMediaRequest&&(window.currentUserMediaRequest.mutex=!1),Object(p.e)(e).alert.then((function(n){"NotFoundError"===e.name||"NotReadableError"===e.name||"OverconstrainedError"===e.name?(t.applyMediaConstraints(!0),t.$toasted.info($t("meeting.media_devices.setup_reset_try_again"),t.$toastConfig.info)):"NotAllowedError"!==e.name&&"PermissionDeniedError"!==e.name||(t.permissionRejected=!0),n.value||(t.isLoading=!1,n.dismiss,b.c.DismissReason.cancel)}))},rtcmOnMute:function(e){this.enableLogs&&console.log("On rtcmOnMute: ",e);var t=this.videoList.findIndex((function(t){return t.id===e.streamid})),n=this.$refs.videos.find((function(t){return t.id===e.streamid}));"video"===e.muteType?this.videoList[t].videoMuted=!0:"audio"===e.muteType?this.videoList[t].muted=!0:(this.videoList[t].videoMuted=!0,this.videoList[t].muted=!0,n.srcObject=null)},rtcmOnUnmute:function(e){this.enableLogs&&console.log(e);var t=this.videoList.findIndex((function(t){return t.id===e.streamid})),n=this.$refs.videos.find((function(t){return t.id===e.streamid}));"video"===e.unmuteType?this.videoList[t].videoMuted=!1:"audio"===e.unmuteType?this.videoList[t].muted=!1:(this.videoList[t].videoMuted=!1,this.videoList[t].muted=!1,n.srcObject=e)},rtcmOnRemoteMuteUnmuted:function(e){this.enableLogs&&console.log(e);var t=this.videoList.findIndex((function(t){return t.id===e.streamid}));-1!==t&&this.videoList[t]&&(e.hasOwnProperty("audioEnabled")?e.audioEnabled?this.videoList[t].audioMuted=!1:this.videoList[t].audioMuted=!0:e.hasOwnProperty("videoEnabled")&&(e.videoEnabled?this.videoList[t].videoMuted=!1:this.videoList[t].videoMuted=!0))},rtcmOnSnapshotTaken:function(e){this.enableLogs&&console.log("rtcmOnSnapshotTaken",e),this.pageConfigs.enableSnapshotAlert&&e&&e.byUser&&e.ofUser&&(this.pageConfigs.snapshotAlertToUserOnly?this.userUuid===e.ofUser.uuid&&(this.$toasted.info($t("meeting.snapshot_taken_notification_your",{by_user:e.byUser.name}),this.$toastConfig.info),Object(p.c)()):(this.userUuid===e.ofUser.uuid?this.$toasted.info($t("meeting.snapshot_taken_notification_your",{by_user:e.byUser.name}),this.$toastConfig.info):this.$toasted.info($t("meeting.snapshot_taken_notification_user",{by_user:e.byUser.name,of_user:e.ofUser.name}),this.$toastConfig.info),Object(p.c)()))},rtcmOnRemoteHandToggled:function(e){if(this.enableLogs&&console.log(e),e&&e.streamid&&this.rtcmConnection.streamEvents[e.streamid]){var t=this.videoList.findIndex((function(t){return t.id===e.streamid}));e.hasOwnProperty("isHandUp")&&(e.isHandUp?(this.videoList[t].isHandUp=!0,this.$toasted.info($t("meeting.handup_notification",{attribute:this.videoList[t].name}),this.$toastConfig.info)):this.videoList[t].isHandUp=!1)}},rtcmOnMuteUnmuteRemote:function(e){this.enableLogs&&console.log(e);var t=this.$refs.videos.find((function(t){return t.id===e.id}));t&&t.srcObject&&this.toggleAudio()},rtcmOnUserIdAlreadyTaken:function(e,t){this.rtcmConnection.userid=t},initMediaAndRtcmConnection:function(){this.rtcmConnection||(this.rtcmConnection=new s.a,this.rtcmConnection.socketURL=window.atob(this.socketURL),this.configs.signalServers&&this.configs.signalServers.url&&(this.rtcmConnection.socketURL=this.configs.signalServers.url),this.rtcmConnection.autoCreateMediaElement=!1,this.configs.meeting&&(this.configs.meeting.debugMode,this.rtcmConnection.enableLogs=!0,this.configs.meeting.forceTurn&&(this.rtcmConnection.candidates={turn:!0,stun:!1,host:!1})),this.rtcmConnection.onopen=this.rtcmOnOpen,this.rtcmConnection.onclose=this.rtcmOnClose,this.rtcmConnection.onleave=this.rtcmOnLeave,this.rtcmConnection.onmessage=this.rtcmOnMessage,this.rtcmConnection.onUserStatusChanged=this.rtcmOnUserStatusChanged,this.rtcmConnection.onstream=this.rtcmOnStream,this.rtcmConnection.onstreamended=this.rtcmOnStreamEnded,this.rtcmConnection.onmute=this.rtcmOnMute,this.rtcmConnection.onunmute=this.rtcmOnUnmute,this.rtcmConnection.onMediaError=this.rtcmOnMediaError,this.rtcmConnection.onUserIdAlreadyTaken=this.rtcmOnUserIdAlreadyTaken,this.pageConfigs.speechDetection&&(this.rtcmConnection.onspeaking=this.rtcmOnSpeaking,this.rtcmConnection.onsilence=this.rtcmOnSilence,this.rtcmConnection.onvolumechange=this.rtcmOnVolumeChange,window.onSilenceTimeoutObj={}),this.rtcmConnection.setCustomSocketEvent("Whisper"),this.fileSharingConnection=this.rtcmConnection),this.getMediaConstraints();this.rtcmConnection.BandwidthHandler;this.rtcmConnection.bandwidth={audio:"auto"!==this.mediaConfigurations.bandwidth.audio&&this.mediaConfigurations.bandwidth.audio,video:"auto"!==this.mediaConfigurations.bandwidth.video&&this.mediaConfigurations.bandwidth.video,screen:"auto"!==this.mediaConfigurations.bandwidth.screen&&this.mediaConfigurations.bandwidth.screen},this.rtcmConnection.iceServers=[{urls:["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302"]}],this.pageConfigs.maxParticipantCount&&(this.rtcmConnection.maxParticipantsAllowed=this.pageConfigs.maxParticipantCount),this.configs.iceServers.length&&(this.rtcmConnection.iceServers=y(this.configs.iceServers)),this.rtcmConnection.session=T({},this.meetingRulesHost.session),this.rtcmConnection.sdpConstraints.mandatory=T({},this.meetingRulesHost.mandatory),this.rtcmConnection.mediaConstraints={video:!!this.meetingRulesHost.mediaConstraints.video&&this.videoConstraints,audio:!!this.meetingRulesHost.mediaConstraints.audio&&this.audioConstraints,screen:this.meetingRulesHost.mediaConstraints.screen}},initSocketListener:function(){if(this.rtcmConnection&&this.rtcmConnection.socket){var e={removedStream:this.streamRemoved,banAttendee:this.banAttendee,muteUnmuteRemote:this.rtcmOnMuteUnmuteRemote,remoteMutedUnmuted:this.rtcmOnRemoteMuteUnmuted,remoteHandToggled:this.rtcmOnRemoteHandToggled,meetingEnded:this.meetingEnded,snapshotTaken:this.rtcmOnSnapshotTaken};this.rtcmConnection.socket.on("Whisper",(function(t){t&&e.hasOwnProperty(t.event)&&e[t.event](t.data)}))}},initCanvasDesigner:function(){this.canvasDesigner=new CanvasDesigner,this.canvasDesigner.widgetHtmlURL="/js/canvas-designer/widget.html",this.canvasDesigner.widgetJsURL="/js/canvas-designer/widget.min.js"},initWhiteboard:function(){var e=this;this.videoList.length<1||!this.$refs.whiteboard||!CanvasDesigner||(this.canvasDesigner||this.initCanvasDesigner(),this.canvasDesigner.addSyncListener((function(t){e.rtcmConnection.send(t)})),this.canvasDesigner.setSelected("pencil"),this.canvasDesigner.setTools({pencil:!0,text:!0,image:!0,pdf:!0,eraser:!0,line:!0,arrow:!0,dragSingle:!0,dragMultiple:!0,arc:!0,rectangle:!0,quadratic:!0,bezier:!1,marker:!0,zoom:!1,lineWidth:!0,colorsPicker:!0,extraOptions:!0,code:!1,undo:!0}),this.canvasDesigner.iframe||this.canvasDesigner.appendTo(this.$refs.whiteboard,(function(){e.rtcmConnection.extra.hasWhiteboard=!0,e.rtcmConnection.updateExtraData(),e.canvasDesigner.captureStream((function(t){e.rtcmConnection.addStream(t),e.rtcmConnection.onstream({streamid:t.id,stream:t,userid:e.rtcmConnection.userid,type:"local",extra:e.rtcmConnection.extra})}))})))},destroyWhiteboard:function(){var e=this;if(this.canvasDesigner){this.canvasDesigner.destroy(),this.canvasDesigner=null;var t=this.$refs.videos.find((function(t){return t.id===e.localWhiteboardStreamid}));t&&t.srcObject?(this.rtcmConnection&&this.localWhiteboardStreamid&&(this.rtcmConnection.removeStream(this.localWhiteboardStreamid),this.rtcmOnStreamEnded({id:this.localWhiteboardStreamid}),this.videoList.length>1&&this.recheckLiveParticipants({streamid:this.localWhiteboardStreamid}),this.autoSetVideoMaximized()),this.emitSocketEvents("removedStream",t.srcObject),this.localWhiteboardStreamid=null):this.localWhiteboardStreamid=null}this.rtcmConnection.extra.hasWhiteboard=!1,this.rtcmConnection.updateExtraData()},hideAndDestroyWhiteboard:function(){var e=this;formUtil.confirmAction().then((function(t){t.value?(e.pageConfigs.layout=e.pageConfigs.lastLayout,e.showWhiteboard=!1,e.destroyWhiteboard()):(t.dismiss,b.c.DismissReason.cancel)}))},getMediaConstraints:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needStreamAddOrReplace=!1,t)return this.audioConstraints={sampleSize:16,channelCount:2,echoCancellation:!1},void(this.videoConstraints={width:{min:426,ideal:1280,max:4096},height:{min:240,ideal:720,max:2160}});this.mediaConfigurations.selectedAudioInput&&this.mediaConfigurations.selectedAudioInput.uuid&&"auto"!==this.mediaConfigurations.selectedAudioInput.uuid?(this.audioConstraints={deviceId:{ideal:this.mediaConfigurations.selectedAudioInput.uuid}},this.audioConstraints.hasOwnProperty("deviceId")&&this.mediaConfigurations.activeAudioInput!==this.audioConstraints.deviceId.ideal&&(this.needStreamAddOrReplace=!0)):this.audioConstraints=!0,this.mediaConfigurations.selectedVideoInput&&this.mediaConfigurations.selectedVideoInput.uuid&&"auto"!==this.mediaConfigurations.selectedVideoInput.uuid?(this.videoConstraints={deviceId:{ideal:this.mediaConfigurations.selectedVideoInput.uuid}},this.videoConstraints.hasOwnProperty("deviceId")&&this.mediaConfigurations.activeVideoInput!==this.videoConstraints.deviceId.ideal&&(this.needStreamAddOrReplace=!0)):delete this.videoConstraints.deviceId,"auto"!==this.mediaConfigurations.facingMode?(this.videoConstraints.facingMode=this.mediaConfigurations.facingMode,this.mediaConfigurations.activeFacingMode!==this.videoConstraints.facingMode&&(this.needStreamAddOrReplace=!0)):this.videoConstraints.hasOwnProperty("facingMode")&&(this.mediaConfigurations.activeFacingMode!==this.videoConstraints.facingMode&&(this.needStreamAddOrReplace=!0),delete this.videoConstraints.facingMode),"auto"!==this.mediaConfigurations.frameRate?this.videoConstraints.frameRate=this.mediaConfigurations.frameRate:this.videoConstraints.hasOwnProperty("frameRate")&&delete this.videoConstraints.frameRate;var n=this.mediaDevices.resolutions.find((function(t){return t.label===e.mediaConfigurations.selectedResolution}));n&&"Auto"!==n.label?(this.videoConstraints.width=n.constraints.width,this.videoConstraints.height=n.constraints.height):(this.videoConstraints.hasOwnProperty("width")&&delete this.videoConstraints.width,this.videoConstraints.hasOwnProperty("height")&&delete this.videoConstraints.height)},applyMediaConstraints:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.rtcmConnection&&this.localVideo&&(this.getMediaConstraints(e),this.rtcmConnection.mediaConstraints={video:!!this.meetingRulesHost.mediaConstraints.video&&this.videoConstraints,audio:!!this.meetingRulesHost.mediaConstraints.audio&&this.audioConstraints,screen:this.meetingRulesHost.mediaConstraints.screen},this.rtcmConnection.bandwidth={audio:"auto"!==this.mediaConfigurations.bandwidth.audio&&this.mediaConfigurations.bandwidth.audio,video:"auto"!==this.mediaConfigurations.bandwidth.video&&this.mediaConfigurations.bandwidth.video,screen:"auto"!==this.mediaConfigurations.bandwidth.screen&&this.mediaConfigurations.bandwidth.screen},this.mediaConfigurations.activeAudioInput=this.audioConstraints.hasOwnProperty("deviceId")?this.audioConstraints.deviceId.ideal:null,this.mediaConfigurations.activeVideoInput=this.videoConstraints.hasOwnProperty("deviceId")?this.videoConstraints.deviceId.ideal:null,this.mediaConfigurations.activeFacingMode=this.mediaConfigurations.facingMode,this.needStreamAddOrReplace?this.closeConnectionAndStream(!0):this.rtcmConnection.applyConstraints(this.rtcmConnection.mediaConstraints))},closeConnectionAndStream:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;if(this.rtcmConnection){if(this.destroyWhiteboard(),this.rtcmConnection.attachStreams.forEach((function(e){e.stop()})),this.$refs.greenRoomVideo&&this.$refs.greenRoomVideo.srcObject){var i=this.$refs.greenRoomVideo.srcObject;i.stop(),this.localGreenRoomStream=null}else if(this.localGreenRoomStream){var r=this.localGreenRoomStream;r.stop(),this.localGreenRoomStream=null}this.localVideo&&this.emitSocketEvents("removedStream",this.localVideo),this.rtcmConnection.getAllParticipants().forEach((function(t){e.rtcmConnection.disconnectWith(t)})),this.rtcmConnection.leave(),this.rtcmConnection.closeSocket(),window.setTimeout((function(){e.localVideo=null,e.localScreenStreamid=null,e.localWhiteboardStreamid=null,e.localGreenRoomStream=null,e.rtcmConnection.recorder=null,e.rtcmConnection=null,t&&e.getOnline(),n&&_.isFunction(n)&&n()}),500)}this.videoList=[]},initHark:function(e){if(window.hark&&this.pageConfigs.speechDetection){var t=e.streamedObject,n=e.stream,i=e.connection,r=d()(n,{});r.on("speaking",(function(){i.onspeaking(t)})),r.on("stopped_speaking",(function(){i.onsilence(t)})),window.harkInitiated=!0}},recheckLiveParticipants:function(e){var t=this,n=[],i=this.rtcmConnection?this.rtcmConnection.getAllParticipants():[];this.videoList.forEach((function(t,r){var o=i.findIndex((function(e){return e===t.streamUserId}));(!e||e&&t.id!==e.streamid)&&(t.local||!t.local&&-1!==o)||(t.status=!1),n.push(t)})),this.videoList=n,setTimeout((function(){t.videoList=t.videoList.filter((function(e){return e.status})),t.autoSetVideoMaximized()}),3e3)},autoSetVideoMaximized:function(){var e=this,t=function(t){e.videoList[t].maximized=!0,e.videoList=e.videoList.map((function(e,n){return e.maximized=!1,n===t&&(e.maximized=!0),e}))};if(this.videoList.length>1)if(-1===this.videoList.findIndex((function(e){return!e.local&&e.maximized&&e.status}))){var n=this.videoList.findIndex((function(e){return!e.local&&e.hasStream}));t(-1!==n?n:0)}else{var i=this.videoList.findIndex((function(e){return!e.local&&e.whiteboard&&e.status}));-1!==i&&this.videoList[i].whiteboard&&t(i)}else this.videoList.length&&t(0)},validateMediaDeviceRequest:function(e){var t={video:!!e.video,audio:!!e.audio,screen:!!e.screen};return this.pageConfigs.allowJoiningWithoutDevices&&(!t.audio||this.mediaDevices.audioInput&&this.mediaDevices.audioInput.length||(t.audio=!1),!t.video||this.mediaDevices.videoInput&&this.mediaDevices.videoInput.length||(t.video=!1)),t},joinRoom:function(e){var t=this;this.rtcmConnection.session=T({},this.meetingRulesGuest.session),this.videoList=[],this.getMediaConstraints();var n=this.entity.canModerate?this.meetingRulesHost:this.meetingRulesGuest,i=this.validateMediaDeviceRequest(n.mediaConstraints);this.rtcmConnection.mediaConstraints={video:!!i.video&&this.videoConstraints,audio:!!i.audio&&this.audioConstraints,screen:i.screen},!this.pageConfigs.allowJoiningWithoutDevices||i.audio||i.video||i.screen||(this.rtcmConnection.dontCaptureUserMedia=!0),this.rtcmConnection.sdpConstraints.mandatory=T({},n.mandatory),this.rtcmConnection.autoCloseEntireSession=n.autoCloseEntireSession,this.rtcmConnection.enableScalableBroadcast=n.enableScalableBroadcast,this.rtcmConnection.enableScalableBroadcast&&(this.rtcmConnection.maxRelayLimitPerUser=n.maxRelayLimitPerUser),this.rtcmConnection.extra.isInitiator=this.entity.canModerate,this.rtcmConnection.join(e,(function(e,n,i){t.isLoading=!1,!1===e||i?(t.closeConnectionAndStream(),"Room full"===i?t.$toasted.error($t("meeting.room_full"),t.$toastConfig.error):t.$toasted.error($t("meeting.unable_to_join"),t.$toastConfig.error)):(t.meetingRoomNotFound=!1,t.updatePageConfigs(t.entity.canModerate),t.initSocketListener(),t.$toasted.success($t("meeting.meeting_joined"),t.$toastConfig))}))},applyOnStartConfigs:function(){var e=this;!this.rtcmConnection.extra.isInitiator&&this.pageConfigs.muteParticipantsOnStart&&window.setTimeout((function(){e.toggleAudio(null,!0)}),1e3)},shareScreen:function(){try{this.rtcmConnection.addStream({screen:!0})}catch(e){}},stopSharingScreen:function(){var e=this;this.isLoading=!0;var t=this.$refs.videos.find((function(t){return t.id===e.localScreenStreamid}));t&&t.srcObject?(t.srcObject.getTracks().forEach((function(t){t.removeEventListener("ended",e.stopSharingScreen),t.enabled=!1,t.stop()})),this.rtcmConnection.removeStream(this.localScreenStreamid),this.emitSocketEvents("removedStream",t.srcObject),this.localScreenStreamid=null,this.isLoading=!1):(this.localScreenStreamid=null,this.isLoading=!1)},getOnline:function(){var e=this;this.isLoading=!0,this.showAgenda=!1;this.entity.status;this.$gaEvent("engagement","meeting_getOnline"),this.initMediaAndRtcmConnection(),this.Custom({url:"/".concat(this.initUrl,"/").concat(this.uuid,"/join"),method:"post"}).then((function(t){e.meetingRoomId=t.meeting.roomId,t.meeting=e.updateMeetingTimezone(t.meeting),e.entity=t.meeting,e.rtcmConnection.extra={username:e.user.username,name:e.user.name,uuid:e.user.uuid,image:e.profile.image,audioMuted:!e.pageConfigs.enableAudio,videoMuted:!e.pageConfigs.enableVideo,isHandUp:e.isHandUp,isInitiator:!1},e.enableLogs&&(console.log("rtcmConnection",e.rtcmConnection),console.log("mediaConfigurations",e.mediaConfigurations),console.log("mediaDevices",e.mediaDevices),console.log("pageConfigs",e.pageConfigs),console.log("videoConstraints",e.videoConstraints),console.log("audioConstraints",e.audioConstraints),console.log("meetingRulesHost",e.meetingRulesHost),console.log("meetingRulesGuest",e.meetingRulesGuest),console.log("rtcmConnection-ExtraData",e.rtcmConnection.extra)),e.rtcmConnection.checkPresence(e.meetingRoomId,(function(t,n){!0===t?(e.meetingRoomNotFound=!1,e.joinRoom(e.meetingRoomId)):(e.isLoading=!1,e.meetingRoomNotFound=!0,e.$toasted.error($t("meeting.room_not_found"),e.$toastConfig.error))}))})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)}))},getOffline:function(){var e=this;this.$gaEvent("engagement","meeting_getOffline"),this.isLoading=!0,this.meetingAction("leave",null,{alert:"confirm",sameCallbackIfError:!0,callback:function(t){e.showAgenda=!0,e.showWhiteboard=!1,"presentation"===e.pageConfigs.layout&&(e.pageConfigs.layout=e.pageConfigs.lastLayout),e.closeConnectionAndStream(!1,(function(){e.setupGreenRoom(),e.initMediaAndRtcmConnection()}))}})},meetingAction:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{alert:"confirm"},r={alert:"confirm"};i=Object.assign({},r,i);var o=function(r){t.isLoading=!0,n=r||n,t.Custom({url:"/".concat(t.initUrl,"/").concat(t.uuid,"/").concat(e),method:"post",data:n}).then((function(e){e.meeting=t.updateMeetingTimezone(e.meeting),t.entity=e.meeting,t.$toasted.success(e.message,t.$toastConfig),i.callback&&i.callback(e),t.isLoading=!1})).catch((function(e){i.callback&&i.sameCallbackIfError&&i.callback(e),t.isLoading=!1,formUtil.handleErrors(e)}))};e?"confirm"===i.alert||!0===i.alert?formUtil.confirmAction().then((function(e){e.value?o():(t.isLoading=!1,e.dismiss,b.c.DismissReason.cancel)})):"input"===i.alert?swtAlert.fire({title:i.title,input:"text",inputPlaceholder:i.inputPlaceholder,showCancelButton:!0,confirmButtonText:"Proceed!",cancelButtonText:"Go Back!"}).then((function(e){if(e.value){var n={};n[i.fieldName]=e.value,o(n)}else t.isLoading=!1,e.dismiss,b.c.DismissReason.cancel})):o():this.isLoading=!1},snoozeMeeting:function(e){this.meetingAction("snooze",{period:e})},cancelMeeting:function(){this.meetingAction("cancel",null,{alert:"input",title:$t("meeting.reason_for_cancellation"),inputPlaceholder:$t("meeting.reason_for_cancellation"),fieldName:"cancellationReason"})},endMeeting:function(){var e=this;this.isLoading=!0,this.meetingAction("end",null,{sameCallbackIfError:!0,callback:function(t){e.showAgenda=!0,e.showWhiteboard=!1,"presentation"===e.pageConfigs.layout&&(e.pageConfigs.layout=e.pageConfigs.lastLayout),e.closeConnectionAndStream(),e.emitSocketEvents("meetingEnded",{status:t.meeting.status})}})},updateMeetingRules:function(){"video_conference"===this.entity.type.uuid?(this.meetingRulesHost={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!1,enableScalableBroadcast:!1},this.meetingRulesGuest={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!1,enableScalableBroadcast:!1}):"audio_conference"===this.entity.type.uuid?(this.meetingRulesHost={session:{audio:!0,video:!1,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1},autoCloseEntireSession:!1,enableScalableBroadcast:!1},this.meetingRulesGuest={session:{audio:!0,video:!1,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1},autoCloseEntireSession:!1,enableScalableBroadcast:!1}):"webinar"===this.entity.type.uuid?(this.meetingRulesHost={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!0},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},autoCloseEntireSession:!0,enableScalableBroadcast:!0,maxRelayLimitPerUser:1},this.meetingRulesGuest={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!0},mediaConstraints:{audio:!1,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!0,enableScalableBroadcast:!0,maxRelayLimitPerUser:1}):"live_class"===this.entity.type.uuid?(this.meetingRulesHost={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!0,enableScalableBroadcast:!1},this.meetingRulesGuest={session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1},mediaConstraints:{audio:!0,video:!0,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},autoCloseEntireSession:!0,enableScalableBroadcast:!1}):"podcast"===this.entity.type.uuid&&(this.meetingRulesHost={session:{audio:!0,video:!1,screen:!1,data:!1,oneway:!0},mediaConstraints:{audio:!0,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},autoCloseEntireSession:!0,enableScalableBroadcast:!0,maxRelayLimitPerUser:1},this.meetingRulesGuest={session:{audio:!0,video:!1,screen:!1,data:!1,oneway:!0},mediaConstraints:{audio:!1,video:!1,screen:!1},mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1},autoCloseEntireSession:!0,enableScalableBroadcast:!0,maxRelayLimitPerUser:1})},updateMeetingTimezone:function(e){var t=this,n=function(e){return g.e(e,t.vars.serverDateTimeFormat)};return e.startDateTime=n(e.startDateTime),e.plannedStartDateTime&&(e.plannedStartDateTime=n(e.plannedStartDateTime)),e},beforeUnload:function(e){this.localVideo&&this.emitSocketEvents("removedStream",this.localVideo)},logEvent:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"log";this.enableLogs&&("log"===n?console.log(e,t):"error"===n?console.error(e,t):"debug"===n&&console.trace(e,t))},toggleDevicesModal:function(){this.mediaConfigFormData=_.cloneDeep(this.mediaConfigurations),this.showDevicesModal=!0},onDevicesModalOK:function(e){var t=this;e.preventDefault(),Object(v.areEqual)(this.mediaConfigFormData,this.mediaConfigurations)||(this.mediaConfigurations=_.cloneDeep(this.mediaConfigFormData),this.applyMediaConstraints()),this.$nextTick((function(){t.$bvModal.hide("devicesModal")}))},onDevicesModalCancel:function(e){var t=this;e.preventDefault(),this.$nextTick((function(){t.$bvModal.hide("devicesModal")}))},updatePageConfigs:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.configs.meeting.recordingFormatAudio?this.configs.meeting.recordingFormatAudio:"audio/webm",i=this.configs.meeting.recordingFormatVideo?this.configs.meeting.recordingFormatVideo:"video/webm",r={},o=this.mediaConfigurations.recording.type,a=this.mediaConfigurations.recording.mimeType;"video_conference"===this.entity.type.uuid?(r={enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!0,enableWhiteboard:!0},o="video",a=i):"audio_conference"===this.entity.type.uuid?(r={enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!1,enableScreenSharing:!1,enableWhiteboard:!1},o="audio",a=n):"webinar"===this.entity.type.uuid?(r=t?{enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!0,enableHandGesture:!1,enableWhiteboard:!0}:{enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!1,showEnableVideoBtn:!1,enableScreenSharing:!1,enableFileSharing:!1,enableRecording:!1,enableHandGesture:!1,enableWhiteboard:!1},o="video",a=i):"live_class"===this.entity.type.uuid?(r=t?{enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!0,showEnableVideoBtn:!0,enableWhiteboard:!0}:{enableAudio:!0,enableVideo:!0,showEnableAudioBtn:!1,showEnableVideoBtn:!1,enableScreenSharing:!1,enableFileSharing:!1,enableRecording:!1,enableWhiteboard:!1},o="video",a=i):"podcast"===this.entity.type.uuid&&(r=t?{enableAudio:!0,enableVideo:!1,showEnableAudioBtn:!0,showEnableVideoBtn:!1,enableScreenSharing:!1,enableHandGesture:!1,enableWhiteboard:!1}:{enableAudio:!0,enableVideo:!1,showEnableAudioBtn:!1,showEnableVideoBtn:!1,enableScreenSharing:!1,enableFileSharing:!1,enableRecording:!1,enableHandGesture:!1,enableWhiteboard:!1},o="audio",a=n),r.objForEach((function(t,n){return e.pageConfigs[n]=t})),this.mediaConfigurations.recording.type=o,this.mediaConfigurations.recording.mimeType=a,this.rtcmConnection.extra.audioMuted=!this.pageConfigs.enableAudio,this.rtcmConnection.extra.videoMuted=!this.pageConfigs.enableVideo,this.rtcmConnection.extra.isHandUp=this.isHandUp,this.rtcmConnection.updateExtraData(),this.pageConfigs.enableWhiteboard&&(Object(h.g)("/js/canvas-designer/webrtc-handler.js"),Object(h.g)("/js/canvas-designer/canvas-designer-widget.js")),this.configs.meeting.debugMode=!0},destroyPage:function(){window.countdownInterval&&clearInterval(window.countdownInterval),this.SetUiConfig({pageHeaderShow:!0,pageFooterShow:!0}),this.closeConnectionAndStream(),window.Echo&&(window.meetingChannel&&(window.meetingChannel.stopListening("MeetingStatusChanged"),window.meetingChannel.stopListening("NewMessage")),window.Echo.leave("Meeting.".concat(this.uuid))),u.a.isEnabled&&(u.a.off("change"),u.a.off("error"))},getInitialData:function(){var e=this;return this.isLoading=!0,window.Echo?this.Custom({url:"/".concat(this.initUrl,"/").concat(this.uuid,"/pam"),method:"get",params:{isPam:!0}}).then((function(t){return t.isInstantMeeting&&(e.pageConfigs.hasAgenda=!1),t.config.objForEach((function(t,n){return e.pageConfigs[n]=t})),e.pageConfigs.disableScroll="grid"===e.pageConfigs.layout||(t.config&&t.config.hasOwnProperty("disableScroll")?t.config.disableScroll:e.pageConfigs.disableScroll),t=e.updateMeetingTimezone(t),e.entity=t,e.updateMeetingRules(),e.pageConfigs.preferRearCameraFirst&&(e.mediaConfigurations.facingMode="environment"),t.roomId&&"live"===t.status&&setTimeout((function(){e.initMediaAndRtcmConnection(),e.rtcmConnection.checkPresence(t.roomId,(function(t,n){e.roomIdAlive=!!t,!0===t&&(e.meetingRoomNotFound=!1)}))}),1e3),e.joinChannel(),e.setupGreenRoom(),t.isInstantMeeting&&!t.isBlocked&&"live"===t.status&&(e.rtcmConnection&&e.rtcmConnection.isInitiator||t.canModerate||"live_class"!==t.type.uuid&&"webinar"!==t.type.uuid)?e.getOnline():e.isLoading=!1,t})).catch((function(t){return e.isLoading=!1,formUtil.handleErrors(t),e.$router.push({name:e.fallBackRoute}),t})):(this.$toasted.error($t("config.pusher.credential_required"),this.$toastConfig.error),void this.$router.push({name:this.fallBackRoute}))},setupGreenRoom:function(){var e=this;this.mediaConfigurations.selectedVideoInput&&(this.getMediaConstraints(),navigator.mediaDevices.getUserMedia({video:this.videoConstraints,audio:this.audioConstraints}).then((function(t){e.localGreenRoomStream=t,e.$refs.greenRoomVideo&&(e.$refs.greenRoomVideo.srcObject=t),setTimeout((function(){if(e.$refs.greenRoomAudio){var n=new AudioContext,i=n.createAnalyser(),r=n.createMediaStreamSource(t),o=n.createScriptProcessor(2048,1,1);i.smoothingTimeConstant=.8,i.fftSize=1024,r.connect(i),i.connect(o),o.connect(n.destination),Object(C.a)(e.$refs.greenRoomAudio,{width:"sibling",boxGapFraction:.2}),o.onaudioprocess=function(){var t=new Uint8Array(i.frequencyBinCount);i.getByteFrequencyData(t);for(var n=0,r=t.length,o=0;o<r;o++)n+=t[o];var a=n/r,s=Math.round(a);e.micVolumeActivity=s<0?0:s}}}),1e3)})).catch((function(t){console.log("navigator.MediaDevices.getUserMedia error: ",t.message,t.name),"NotAllowedError"!==t.name&&"PermissionDeniedError"!==t.name||(e.permissionRejected=!0)})))},setupMediaDevices:function(){var e=this;this.isLoading=!0;navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(e){return e.getTracks().forEach((function(e){return e.stop()})),navigator.mediaDevices.enumerateDevices()})).then((function(t){t.forEach((function(t){var n={uuid:t.deviceId};"audioinput"===t.kind?(n.name=t.label||"microphone ".concat(e.mediaDevices.audioInput.length+1),e.mediaDevices.audioInput.push(n)):"audiooutput"===t.kind?(n.name=t.label||"speaker ".concat(e.mediaDevices.audioOutput.length+1),e.mediaDevices.audioOutput.push(n)):"videoinput"===t.kind?(n.name=t.label||"camera ".concat(e.mediaDevices.videoInput.length+1),e.mediaDevices.videoInput.push(n)):console.log("Some other kind of source/device: ",t)})),e.mediaConfigurations.selectedAudioInput=e.mediaDevices.audioInput?e.mediaDevices.audioInput[0]:null,e.mediaConfigurations.selectedVideoInput=e.mediaDevices.videoInput?e.mediaDevices.videoInput[0]:null,e.mediaConfigFormData=_.cloneDeep(e.mediaConfigurations),e.getInitialData()})).catch((function(t){console.log("navigator.MediaDevices.getUserMedia error: ",t.message,t.name),"NotAllowedError"!==t.name&&"PermissionDeniedError"!==t.name||(e.permissionRejected=!0),e.getInitialData()}))},doInit:function(){this.Init({url:this.initUrl}),window.isDuplicate()&&(this.duplicateTab=!0),this.setupMediaDevices()},updateUsername:function(){var e=this;swtAlert.fire({title:$t("misc.ask_name.title"),showCancelButton:!0,confirmButtonText:$t("misc.ask_name.confirm_btn"),cancelButtonText:$t("misc.ask_name.cancel_btn_2"),input:"text"}).then((function(t){if(t.value){var n=Object(h.e)("guestUserData",!0)||{};(n=T(T({},e.profile),n)).username=Object(v.toSnakeCase)(t.value),n.name=t.value,e.profile=T({},n),Object(h.j)("guestUserData",n),e.rtcmConnection.extra.username=e.profile.username,e.rtcmConnection.extra.name=e.profile.name,e.rtcmConnection.updateExtraData()}else t.dismiss,b.c.DismissReason.cancel}))},setDefaultGuestUserData:function(){var e=Object(h.e)("guestUserData",!0);if(!e||!e.uuid){var t=uuid().substring(0,8);e={uuid:uuid(),username:t,name:t}}this.profile=T({},e),Object(h.j)("guestUserData",e)}}),mounted:function(){var e=this;document.body.classList.add("meeting-page"),this.$route.params.uuid&&(this.uuid=this.$route.params.uuid),u.a.isEnabled&&(u.a.on("change",(function(){e.SetUiConfig({fullScreen:u.a.isFullscreen})})),u.a.on("error",(function(e){console.error("Failed to enable fullscreen",e)})),this.SetUiConfig({fullScreen:!1})),this.GetConfig({params:{pam:!0,meeting:this.uuid}}).then((function(t){t&&t.pusher&&t.signalServers&&t.iceServers?(e.isLoading=!1,window.Echo||Object(m.a)(),e.doInit()):(e.$toasted.error($t("meeting.pam_meeting_error"),e.$toastConfig.error),e.$router.push({name:"login",query:{ref:e.$route.fullPath}}))})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)})),window.addEventListener("beforeunload",this.beforeUnload),this.checkIfOffline()},created:function(){this.mediaConfigFormData=_.cloneDeep(this.mediaConfigurations),this.SetUiConfig({pageHeaderShow:!1,pageFooterShow:!1}),this.setDefaultGuestUserData(),navigator.connection&&"cellular"===navigator.connection.type&&navigator.connection.downlinkMax<=.115&&alert("2G is not supported. Please use a better internet service.")},beforeRouteEnter:function(e,t,n){e.params.uuid?n((function(e){e.prevRoute=t})):n({name:"joinMeetingAsGuest"})},beforeDestroy:function(){window.isMeetingPageDestroyed||(this.isLoading=!0,this.destroyPage(),this.entity&&"live"===this.entity.status&&this.Custom({url:"/".concat(this.initUrl,"/").concat(this.uuid,"/leave"),method:"post"}),window.isMeetingPageDestroyed=!0)},beforeRouteLeave:function(e,t,n){var i=this,r=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(i.isLoading=!0,i.destroyPage(),window.removeEventListener("beforeunload",i.beforeUnload),i.entity&&"live"===i.entity.status?i.Custom({url:"/".concat(i.initUrl,"/").concat(i.uuid,"/leave"),method:"post"}).then((function(e){window.isMeetingPageDestroyed=!0,n()})).catch((function(e){window.isMeetingPageDestroyed=!0,n()})):(window.isMeetingPageDestroyed=!0,n()))};this.hasVideos?formUtil.unsavedCheckAlert({},{unsaved:!0},r,{title:$t("meeting.is_live")}):r()},destroyed:function(){document.body.classList.remove("meeting-page")}};n("i8R7"),n("BcCH");function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O={data:function(){return{subscriptions:{},isWindowFocused:!0,socketURL:"aHR0cHM6Ly9zaWduYWwua29kZW1pbnQuaW46OTAwMS8="}},computed:D({},Object(i.c)("config",["configs","uiConfigs","vars"])),methods:D(D({},Object(i.b)("common",["Custom"])),{},{leaveBeforeUnload:function(){},windowBlurred:function(){this.isWindowFocused=!1},windowFocused:function(){this.isWindowFocused=!0},updateNotificationSubscription:function(e){var t=e.getKey("p256dh"),n=e.getKey("auth"),i=(PushManager.supportedContentEncodings||["aesgcm"])[0],r={endpoint:e.endpoint,publicKey:t?btoa(String.fromCharCode.apply(null,new Uint8Array(t))):null,authToken:n?btoa(String.fromCharCode.apply(null,new Uint8Array(n))):null,contentEncoding:i};this.Custom({url:"users/subscriptions",method:"post",data:r}).then((function(e){}))},socketSetup:function(){this.socketURLB=window.atob(this.socketURL);try{var e=o()(this.socketURLB);e.on("connect",(function(){e.emit("socketAuth",{token:201005})})),e.on("socketAuthError",(function(){Object(f.a)(!0)})),window.setTimeout((function(){e&&e.disconnect()}),5e3)}catch(e){console.log(e)}}}),mounted:function(){var e=this;window.Echo||Object(m.a)(),this.configs&&this.configs.disableSocketVerification||window.setTimeout((function(){e.socketSetup()}),1e3)},created:function(){window.addEventListener("beforeunload",this.leaveBeforeUnload),window.addEventListener("blur",this.windowBlurred),window.addEventListener("focus",this.windowFocused)},beforeDestroy:function(){},destroyed:function(){window.removeEventListener("beforeunload",this.leaveBeforeUnload),window.removeEventListener("blur",this.windowBlurred),window.removeEventListener("focus",this.windowFocused)}},M=n("bdEB"),L=n("adPT"),I=n("K2Rr"),A=n.n(I),j={mixins:[O,k],components:{AppLogo:M.a,AnimatedNumber:L.a,FlipCountdown:A.a},watch:{locked:function(e,t){if(e){var n=this.$route.fullPath;this.$router.push({name:"authLock",query:{ref:n}})}}},methods:{},mounted:function(){}},$=n("KHd+"),U=Object($.a)(j,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("base-container",{class:["meeting-page",{"auto-hide-footer":e.pageConfigs.footerAutoHide&&e.hasVideos},{pulse:e.recording},{"mirrored-video":e.configs.meeting&&e.configs.meeting.mirroredVideo}],attrs:{"with-loader":"","is-loading":e.isLoading,"loader-color":e.vars.loaderColor,"overlay-color":e.uiConfigs.pageColorSchemeType,"loader-size":"screen","data-page-background-color":e.uiConfigs.pageBackgroundColor,"data-card-background-color":e.uiConfigs.pageContainerBackgroundColor}},[e.duplicateTab?n("card",{staticClass:"duplicate-tab d-flex justify-content-center align-items-center min-height-90vh",attrs:{shadow:""}},[n("h2",[e._v(e._s(e.$t("meeting.duplicate_tab")))])]):[n("div",{class:["meeting-footer",{"has-videos":e.hasVideos}],attrs:{"data-footer-background-color":e.uiConfigs.leftSidebarColor}},[n("div",{staticClass:"logo-wrapper"},[n("app-logo",{attrs:{place:"sidebar",size:"sm",tag:"span"}})],1),e._v(" "),e.entity&&e.entity.status&&e.videoList.length?n("div",{staticClass:"meeting-actions meeting-actions-center"},[e.localVideo&&e.pageConfigs.showEnableAudioBtn?[e.pageConfigs.enableAudio?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action",attrs:{type:"button",title:e.$t("meeting.mute_audio")},on:{click:e.toggleAudio}},[n("i",{staticClass:"fas fa-microphone"})]):n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action disabled-text",attrs:{type:"button",title:e.$t("meeting.unmute_audio")},on:{click:e.toggleAudio}},[n("i",{staticClass:"fas fa-microphone-slash"})])]:e._e(),e._v(" "),e.localVideo&&e.pageConfigs.showEnableVideoBtn?[e.pageConfigs.enableVideo?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action",attrs:{type:"button",title:e.$t("meeting.mute_video")},on:{click:e.toggleVideo}},[n("i",{staticClass:"fas fa-video"})]):n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action disabled-text",attrs:{type:"button",title:e.$t("meeting.unmute_video")},on:{click:e.toggleVideo}},[n("i",{staticClass:"fas fa-video-slash"})])]:e._e(),e._v(" "),e.pageConfigs.showDeviceConfig?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-sm-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.media_devices.setup")},on:{click:e.toggleDevicesModal}},[n("i",{staticClass:"fas fa-cogs"})]):e._e(),e._v(" "),n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text",attrs:{type:"button",title:e.$t("meeting.leave_meeting")},on:{click:e.getOffline}},[n("i",{staticClass:"fas fa-phone-slash"})]),e._v(" "),e.pageConfigs.enableScreenSharing&&e.pageConfigs.pamEnableScreenSharingForGuest?[e.localScreenStreamid?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action disabled-text d-none d-lg-inline-block",attrs:{type:"button",title:e.$t("meeting.stop_sharing_screen")},on:{click:e.stopSharingScreen}},[n("i",{staticClass:"fas fa-minus-square"})]):n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-lg-inline-block",attrs:{type:"button",title:e.$t("meeting.share_screen")},on:{click:e.shareScreen}},[n("i",{staticClass:"fas fa-desktop"})])]:e._e(),e._v(" "),e.pageConfigs.enableWhiteboard&&e.pageConfigs.pamEnableWhiteboardForGuest?[e.showWhiteboard?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.hide_whiteboard")},on:{click:e.toggleWhiteboard}},[n("i",{staticClass:"fas fa-chalkboard-teacher"})]):e._e(),e._v(" "),e.showWhiteboard?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.clear_hide_whiteboard")},on:{click:e.hideAndDestroyWhiteboard}},[n("i",{staticClass:"fas fa-chalkboard-teacher mr-0"}),n("i",{staticClass:"fas fa-times font-size-xs ml-1 font-size-xs text-danger"})]):n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.show_whiteboard")},on:{click:e.toggleWhiteboard}},[n("i",{staticClass:"fas fa-chalkboard-teacher"})])]:e._e(),e._v(" "),e.pageConfigs.enableHandGesture?[e.isHandUp?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action success-text",attrs:{type:"button",title:e.$t("meeting.lower_hand")},on:{click:e.toggleHandUp}},[n("i",{staticClass:"far fa-hand-paper"})]):n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action",attrs:{type:"button",title:e.$t("meeting.raise_hand")},on:{click:e.toggleHandUp}},[n("i",{staticClass:"fas fa-hand-paper"})])]:e._e()],2):e._e(),e._v(" "),n("div",{staticClass:"meeting-actions meeting-actions-right"},[e.entity?[e.entity.status&&e.videoList.length&&"presentation"!==e.pageConfigs.layout?n("base-dropdown",{staticClass:"more-actions d-none d-md-inline-block",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up",position:"right"}},[n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action grid-toggle-btn d-none d-md-inline-block",attrs:{slot:"title",type:"button",title:e.$t("meeting.change_layout")},slot:"title"},[n("i",{staticClass:"fas fa-th-large"})]),e._v(" "),n("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("grid")}}},[e._v(e._s(e.$t("meeting.grid_layout"))+" "),n("i",{staticClass:"fas fa-check min-width-auto text-light",class:{"text-dark":"grid"===e.pageConfigs.layout}})]),e._v(" "),n("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("gallery")}}},[e._v(e._s(e.$t("meeting.gallery_layout"))+" "),n("i",{staticClass:"fas fa-check min-width-auto text-light",class:{"text-dark":"gallery"===e.pageConfigs.layout}})]),e._v(" "),e.pageConfigs.hasAgenda||e.pageConfigs.enableWhiteboard&&e.showWhiteboard?n("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("presentation")}}},[e._v(e._s(e.$t("meeting.presentation_layout"))+" "),n("i",{staticClass:"fas fa-check min-width-auto text-light",class:{"text-dark":"presentation"===e.pageConfigs.layout}})]):e._e(),e._v(" "),n("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("fullpage")}}},[e._v(e._s(e.$t("meeting.fullpage_layout"))+" "),"fullpage"===e.pageConfigs.layout?n("i",{staticClass:"fas fa-check min-width-auto text-light",class:{"text-dark":"fullpage"===e.pageConfigs.layout}}):e._e()])]):e._e(),e._v(" "),e.pageConfigs.enableChat&&e.configs.chat&&e.configs.chat.enabled&&e.subscriptions&&e.subscriptions.userPrivate&&!e.entity.isBlocked?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],class:["btn action chats-toggle-btn",{pulse:e.totalUnreadMessages&&e.totalUnreadMessages>0&&!e.isChatBoxShown}],attrs:{type:"button",title:e.$t(e.isChatBoxShown?"global.hide":"global.show",{attribute:e.$t("chat.chats")})},on:{click:e.toggleChatBox}},[n("i",{class:[e.isChatBoxShown?"fas fa-comment-slash":"far fa-comment"]}),e._v(" "),e.totalUnreadMessages&&e.totalUnreadMessages>0?n("span",{staticClass:"text-success unread-count"},[e._v(e._s(e.totalUnreadMessages))]):e._e()]):e._e()]:e._e(),e._v(" "),n("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up",position:"right"}},[n("button",{staticClass:"btn action more-actions-btn",attrs:{slot:"title",type:"button"},slot:"title"},[n("i",{staticClass:"fas fa-ellipsis-v"})]),e._v(" "),e.entity&&e.entity.status&&e.videoList.length?n("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.getOffline}},[n("i",{staticClass:"fas fa-phone-slash"}),e._v(" "+e._s(e.$t("meeting.leave_meeting")))]):n("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(t){return e.$router.back()}}},[n("i",{staticClass:"fas fa-chevron-left"}),e._v(" "+e._s(e.$t("general.back")))]),e._v(" "),e.entity&&e.entity.status&&e.entity.canModerate&&"live"===e.entity.status?n("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.endMeeting}},[n("i",{staticClass:"fas fa-calendar-times"}),e._v(" "+e._s(e.$t("meeting.end_meeting")))]):e._e(),e._v(" "),n("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.updateUsername}},[n("i",{staticClass:"fas fa-user"}),e._v(" "+e._s(e.$t("meeting.update_username")))]),e._v(" "),n("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),e._v(" "),e.pageConfigs.hasAgenda?n("button",{staticClass:"dropdown-item agenda-toggle-btn",attrs:{type:"button"},on:{click:e.toggleAgenda}},[n("i",{staticClass:"fas fa-quote-left"}),e._v(" "+e._s(e.$t(e.showAgenda?"global.hide":"global.show",{attribute:e.$t("general.agenda")})))]):e._e(),e._v(" "),n("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:e.toggleFooterAutoHide}},[n("i",{staticClass:"fas fa-hourglass-start"}),e._v(" "+e._s(e.$t(e.pageConfigs.footerAutoHide?"meeting.toggle_autohide_off":"meeting.toggle_autohide_on")))]),e._v(" "),e.uiConfigs.fullScreen?n("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:function(t){return e.toggleFullScreen(!1)}}},[n("i",{staticClass:"fas fa-compress"}),e._v(" "+e._s(e.$t("config.ui.toggle_fullscreen")))]):n("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:function(t){return e.toggleFullScreen(!0)}}},[n("i",{staticClass:"fas fa-expand"}),e._v(" "+e._s(e.$t("config.ui.toggle_fullscreen")))]),e._v(" "),n("div",{staticClass:"dropdown-divider d-md-none my-1",attrs:{role:"separator"}}),e._v(" "),n("button",{staticClass:"dropdown-item d-md-none",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("grid")}}},[n("i",{staticClass:"fas fa-check text-light",class:{"text-dark":"grid"===e.pageConfigs.layout}}),e._v(" "+e._s(e.$t("meeting.grid_layout")))]),e._v(" "),n("button",{staticClass:"dropdown-item d-md-none",attrs:{type:"button"},on:{click:function(t){return e.toggleLayout("fullpage")}}},[n("i",{staticClass:"fas fa-check text-light",class:{"text-dark":"fullpage"===e.pageConfigs.layout}}),e._v(" "+e._s(e.$t("meeting.fullpage_layout")))]),e._v(" "),n("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),e._v(" "),e.pageConfigs.showDeviceConfig?n("button",{staticClass:"dropdown-item show-devices-btn",attrs:{type:"button"},on:{click:e.toggleDevicesModal}},[n("i",{staticClass:"fas fa-cogs"}),e._v(" "+e._s(e.$t("meeting.media_devices.setup")))]):e._e(),e._v(" "),e.pageConfigs.enableLinkSharing&&e.pageConfigs.pamEnableLinkSharingForGuest?n("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.shareURL}},[n("i",{staticClass:"fas fa-share-alt"}),e._v(" "+e._s(e.$t("general.share_url")))]):e._e()])],2)]),e._v(" "),n("div",{class:["agenda-streams-container",{"has-agenda":e.pageConfigs.hasAgenda||e.hasVideos&&e.pageConfigs.enableWhiteboard},{"agenda-visible":e.showAgenda||e.hasVideos&&e.showWhiteboard}]},[e.entity&&!e.entity.isBlocked?[e.pageConfigs.hasAgenda?[n("card",{staticClass:"agenda-container",attrs:{shadow:"","body-classes":"agenda-wrapper"}},[n("div",{staticClass:"meeting-agenda-container"},[n("vue-scroll",{ref:"vue-scroll-agenda",attrs:{id:"vue-scroll-agenda"}},[e.entity?[e._m(0),e._v(" "),n("div",{staticClass:"text-muted mt-3"},[e._m(1),e._v(" "),e._m(2)]),e._v(" "),n("view-paragraph",{staticClass:"mt-3",attrs:{label:e.$t("meeting.props.agenda"),value:e.entity.agenda}}),e._v(" "),e.entity.description?n("view-paragraph",{staticClass:"mt-3",attrs:{label:e.$t("meeting.props.description"),value:e.entity.description,html:""}}):e._e(),e._v(" "),e.entity.attachments?n("view-uploads",{class:["mt-3",e.uiConfigs.colorSchemeType],attrs:{label:e.$t("upload.attachments"),"name-label":e.$t("upload.attachment"),value:e.entity.attachments,"download-button-classes":"text-gray","url-prefix":"/meetings/"+e.uuid+"/downloads"}}):e._e()]:e._e()],2)],1)])]:e._e(),e._v(" "),e.hasVideos&&e.pageConfigs.enableWhiteboard?[n("card",{staticClass:"whiteboard-container",attrs:{shadow:"","body-classes":"whiteboard-wrapper"}},[n("div",{staticClass:"meeting-whiteboard-container"},[n("vue-scroll",{ref:"vue-scroll-whiteboard",attrs:{id:"vue-scroll-whiteboard"}},[n("div",{ref:"whiteboard",staticClass:"whiteboard",attrs:{id:"whiteboard"}})])],1)])]:e._e()]:e._e(),e._v(" "),n("div",{class:["streams-container",e.hasVideos?"stream-"+e.pageConfigs.layout+"-layout":""]},[n("div",{ref:"videoListEle",class:["video-list",e.hasVideosClasses]},[e.hasVideos?e._l(e.videoList,(function(t,i){return n("div",{key:""+t.uuid+t.id,class:["video-item video-card",{maximized:t.maximized},{local:t.local},{screen:t.screen},{whiteboard:t.whiteboard},{"fullscreen-item":t.id===e.fullScreenItemId},{"hand-up":t.isHandUp},{"user-speaking":t.speaking},{"audio-muted":t.audioMuted},{"video-muted":t.videoMuted||!t.hasVideo},{"no-stream":!t.status},{"disable-mirror":t.disableMirror}],on:{dblclick:function(n){return e.changeFocus(t)}}},[n("div",{staticClass:"video-wrapper"},[n("video",{ref:"videos",refInFor:!0,class:[{"no-poster":t.status&&!t.videoMuted}],attrs:{autoplay:"",playsinline:"",id:t.id,poster:t.status?null:"/images/video/no-stream.jpg"},domProps:{muted:t.muted}}),e._v(" "),n("div",{staticClass:"caption"},[n("h6",[n("span",{class:["text-xs mr-1",{"text-success":t.status},{"text-danger":!t.status}]},[n("i",{staticClass:"fas fa-circle"})]),e._v(" "),t.local?[e._v("\n                                            "+e._s(t.screen?e.$t("meeting.your_screen"):t.whiteboard?e.$t("meeting.your_whiteboard"):e.$t("meeting.you"))+"\n                                        ")]:[e._v("\n                                            "+e._s(t.screen?""+t.name+e.$t("meeting.screen"):t.whiteboard?""+t.name+e.$t("meeting.whiteboard"):t.name)+"\n                                        ")],e._v(" "),t.status?e._e():n("span",{staticClass:"bracketed text-danger"},[e._v(e._s(e.$t("meeting.left")))])],2)]),e._v(" "),n("div",{staticClass:"highlight-border"})]),e._v(" "),t.local?t.local&&t.isHandUp?n("div",{staticClass:"custom-controls-wrapper"},[n("div",{staticClass:"custom-controls"},[n("div",{staticClass:"status-icon"},[n("i",{staticClass:"fas fa-hand-paper enabled-text"})])])]):e._e():n("div",{staticClass:"custom-controls-wrapper"},[n("div",{staticClass:"custom-controls"},[t.isHandUp?n("div",{staticClass:"status-icon"},[n("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e(),e._v(" "),e.entity.canModerate||!t.audioMuted||t.videoMuted?e._e():n("div",{staticClass:"status-icon"},[n("i",{staticClass:"fas fa-microphone-slash disabled-text"})]),e._v(" "),n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],attrs:{title:e.$t("meeting.toggle_mirror_flip")},on:{click:function(n){return e.disableMirror(t,i)}}},[n("i",{staticClass:"fas fa-exchange-alt enabled-text"})]),e._v(" "),e.pageConfigs.enableSnapshot&&e.pageConfigs.anyoneCanTakeSnapshot?n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],attrs:{title:e.$t("meeting.take_snapshot")},on:{click:function(n){return e.takeSnapshotOfStream(t,i)}}},[n("i",{staticClass:"fas fa-image enabled-text"})]):e._e(),e._v(" "),n("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],attrs:{title:e.$t("meeting.mute_participant")},on:{click:function(n){return e.toggleRemoteAudio(t,i)}}},[n("i",{class:["fas",{"fa-volume-up enabled-text":!t.muted},{"fa-volume-off disabled-text":t.muted}]})])])])])})):n("card",{staticClass:"video-item wait-box maximized",attrs:{shadow:""}},[e.entity&&!e.entity.isBlocked?["scheduled"===e.entity.status||"live"===e.entity.status?[n("div",{staticClass:"green-room text-center mt-3"},[n("video",{ref:"greenRoomVideo",attrs:{autoplay:"",playsinline:"",muted:"",id:"greenRoomVideo"},domProps:{muted:!0}}),e._v(" "),n("br"),e._v(" "),n("canvas",{ref:"greenRoomAudio",staticStyle:{margin:"0 auto"},attrs:{id:"greenRoomAudio",width:"250",height:"15","data-val":e.micVolumeActivity}},[e._v("No canvas")])])]:e._e(),e._v(" "),"scheduled"===e.entity.status?[e.startDateTimeIsFuture?n("flip-countdown",{staticClass:"my-3",attrs:{deadline:e.entity.startDateTime}}):[n("h5",{staticClass:"text-muted text-center my-3"},[e._v("\n                                        "+e._s(e.$t("meeting.starting_any_time_now"))+"\n                                    ")])],e._v(" "),n("div",{staticClass:"text-center my-3"},[n("span",{staticClass:"text-muted"},[e._v(e._s(e.$t("meeting.scheduled_for")))]),n("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"text-muted-lg m-l-5",attrs:{title:e._f("momentDateTime")(e.entity.startDateTime)}},[e._v(e._s(e._f("momentCalendar")(e.entity.startDateTime,{sameElse:e.vars.defaultDateTimeFormat})))])]),e._v(" "),e.liveMembersCount>0?n("div",{staticClass:"text-muted text-center my-3"},[n("span",{staticClass:"text-xs text-success mr-1"},[n("i",{staticClass:"fas fa-circle"})]),e._v(" "),n("animated-number",{attrs:{number:e.liveMembersCount,delay:100}}),e._v(" "),e.liveMembersCount>1?n("span",[e._v(e._s(e.$t("meeting.members_online")))]):n("span",[e._v(e._s(e.$t("meeting.member_online")))])],1):e._e()]:"live"===e.entity.status?[e.roomIdAlive?[n("h5",{staticClass:"text-muted text-center my-3"},[e._v("\n                                        "+e._s(e.$t("meeting.is_live_now"))+"\n                                    ")]),e._v(" "),n("div",{staticClass:"d-flex justify-content-center my-3"},[n("base-button",{attrs:{type:"button",design:"primary",size:"lg"},on:{click:e.getOnline}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("meeting.get_live")})))])],1)]:[n("h5",{staticClass:"text-muted text-center my-3"},[e._v("\n                                        "+e._s(e.$t("meeting.starting_any_time_now"))+"\n                                    ")])],e._v(" "),e.liveMembersCount>0?n("div",{staticClass:"text-muted text-center my-3"},[n("span",{staticClass:"text-xs text-success mr-1"},[n("i",{staticClass:"fas fa-circle"})]),e._v(" "),n("animated-number",{attrs:{number:e.liveMembersCount,delay:100}}),e._v(" "),e.liveMembersCount>1?n("span",[e._v(e._s(e.$t("meeting.members_online")))]):n("span",[e._v(e._s(e.$t("meeting.member_online")))])],1):e._e()]:"cancelled"===e.entity.status?[n("h4",{staticClass:"text-muted text-center my-3"},[e._v("\n                                    "+e._s(e.$t("meeting.meeting_cancelled"))+"\n                                ")]),e._v(" "),n("div",{staticClass:"d-flex justify-content-center"},[n("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(t){return e.$router.back()}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:"ended"===e.entity.status?[n("h4",{staticClass:"text-muted text-center my-3"},[e._v("\n                                    "+e._s(e.$t("meeting.meeting_ended"))+"\n                                ")]),e._v(" "),n("div",{staticClass:"d-flex justify-content-center"},[n("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(t){return e.$router.back()}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:e._e()]:[e.entity?n("h3",{staticClass:"text-center text-danger my-3"},[e._v("\n                                "+e._s(e.$t("meeting.not_allowed"))+"\n                            ")]):e._e()]],2)],2)])],2),e._v(" "),n("b-modal",{attrs:{size:"md",centered:"",lazy:"",busy:e.isLoading,id:"devicesModal","no-close-on-backdrop":"","no-close-on-esc":""},on:{ok:e.onDevicesModalOK,cancel:e.onDevicesModalCancel},model:{value:e.showDevicesModal,callback:function(t){e.showDevicesModal=t},expression:"showDevicesModal"}},[n("template",{slot:"modal-header"},[n("h5",{staticClass:"modal-title"},[e._v(e._s(e.$t("meeting.media_devices.video_and_audio_devices")))])]),e._v(" "),n("div",[n("base-select",{attrs:{options:e.mediaDevices.audioInput,label:e.$t("meeting.media_devices.audio_input"),"allow-empty":!1,"preselect-first":""},model:{value:e.mediaConfigFormData.selectedAudioInput,callback:function(t){e.$set(e.mediaConfigFormData,"selectedAudioInput",t)},expression:"mediaConfigFormData.selectedAudioInput"}}),e._v(" "),n("base-select",{attrs:{options:e.mediaDevices.videoInput,label:e.$t("meeting.media_devices.video_input"),"allow-empty":!1,"preselect-first":""},model:{value:e.mediaConfigFormData.selectedVideoInput,callback:function(t){e.$set(e.mediaConfigFormData,"selectedVideoInput",t)},expression:"mediaConfigFormData.selectedVideoInput"}}),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-12 col-md-4"},[n("base-select",{attrs:{options:e.mediaDevices.resolutions,label:e.$t("meeting.media_devices.video_resolution"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"label","show-by":"label"},model:{value:e.mediaConfigFormData.selectedResolution,callback:function(t){e.$set(e.mediaConfigFormData,"selectedResolution",t)},expression:"mediaConfigFormData.selectedResolution"}})],1),e._v(" "),n("div",{staticClass:"col-12 col-md-4"},[n("base-select",{attrs:{options:e.mediaDevices.frameRates,label:e.$t("meeting.media_devices.frame_rate"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.frameRate,callback:function(t){e.$set(e.mediaConfigFormData,"frameRate",t)},expression:"mediaConfigFormData.frameRate"}})],1),e._v(" "),n("div",{staticClass:"col-12 col-md-4"},[n("base-select",{attrs:{options:e.mediaDevices.facingModes,label:e.$t("meeting.media_devices.facing_mode"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.facingMode,callback:function(t){e.$set(e.mediaConfigFormData,"facingMode",t)},expression:"mediaConfigFormData.facingMode"}})],1),e._v(" "),n("div",{staticClass:"col-12"},[n("h6",{staticClass:"mt-2 pb-1"},[e._v(e._s(e.$t("meeting.media_devices.bandwidth")))])]),e._v(" "),n("div",{staticClass:"col-12 col-sm-4"},[n("base-select",{attrs:{options:e.audioBandwidthOpts,label:e.$t("meeting.media_devices.audio"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.bandwidth.audio,callback:function(t){e.$set(e.mediaConfigFormData.bandwidth,"audio",t)},expression:"mediaConfigFormData.bandwidth.audio"}})],1),e._v(" "),n("div",{staticClass:"col-12 col-sm-4"},[n("base-select",{attrs:{options:e.videoBandwidthOpts,label:e.$t("meeting.media_devices.video"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.bandwidth.video,callback:function(t){e.$set(e.mediaConfigFormData.bandwidth,"video",t)},expression:"mediaConfigFormData.bandwidth.video"}})],1),e._v(" "),n("div",{staticClass:"col-12 col-sm-4"},[n("base-select",{attrs:{options:e.screenBandwidthOpts,label:e.$t("meeting.media_devices.screen"),"allow-empty":!1,"preselect-first":"",simple:"","track-by":"uuid","show-by":"label"},model:{value:e.mediaConfigFormData.bandwidth.screen,callback:function(t){e.$set(e.mediaConfigFormData.bandwidth,"screen",t)},expression:"mediaConfigFormData.bandwidth.screen"}})],1)])],1)],2)]],2)}),[function(){var e=this.$createElement;return(this._self._c||e)("h4",{staticClass:"meeting-title"},[this._v(this._s(this.entity.title))])},function(){var e=this.$createElement;return(this._self._c||e)("span",[this._v(this._s(this.$t("meeting.props.type"))+": "+this._s(this.entity.type.name)+",")])},function(){var e=this.$createElement;return(this._self._c||e)("span",[this._v(this._s(this.$t("meeting.meeting_category.category"))+": "+this._s(this.entity.category.name))])}],!1,null,null,null);t.default=U.exports},adPT:function(e,t,n){"use strict";var i={name:"animated-number",props:{number:{type:Number,default:0},delay:{type:Number,default:20}},data:function(){return{displayNumber:0,interval:!1,initialInterval:!1}},methods:{changeNumberFn:function(){if(this.displayNumber!=this.number){var e=(this.number-this.displayNumber)/10;e=e>=0?Math.ceil(e):Math.floor(e),this.displayNumber=this.displayNumber+e}}},watch:{number:function(){clearInterval(this.interval),this.number!=this.displayNumber&&(this.interval=window.setInterval(this.changeNumberFn,this.delay))}},mounted:function(){this.displayNumber=0,clearInterval(this.initialInterval),this.number!=this.displayNumber&&(this.initialInterval=window.setInterval(this.changeNumberFn,this.delay))}},r=n("KHd+"),o=Object(r.a)(i,(function(){var e=this.$createElement;return(this._self._c||e)("span",[this._v(this._s(this.displayNumber))])}),[],!1,null,null,null);t.a=o.exports},akQX:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d}));var i=n("V0LQ");navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert($t("misc.get_user_media_not_supported")),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=function(e){navigator.mediaDevices.enumerateDevices().then(e)});location.protocol;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack||navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices;var r=function(e){var t={icon:"error",footer:$t("misc.solve_and_refresh")};if(e)return"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?(t.title=$t("misc.media.permission_denied"),t.text=$t("misc.media.permission_denied_text")):"NotFoundError"===e.name?(t.title=$t("misc.media.not_found"),t.text=$t("misc.media.not_found_text")):"NotReadableError"===e.name||"OverconstrainedError"===e.name?(t.title=$t("misc.media.unreadable"),t.text=$t("misc.media.unreadable_text")):"SecurityError"!==e.name&&"TypeError"!==e.name||(t.title=$t("misc.media.security"),t.text=$t("misc.media.security_text")),{msg:t,alert:swtAlert.fire(t)}},o=function(e){if((e=Object.assign({},{type:null,loop:!1,duration:1e3},e)).type){var t=new Audio;return t.preload="auto",t.autoplay=!0,t.loop=e.loop,t.src="/sound/".concat(e.type,".mp3"),t.play().then((function(){setTimeout((function(){t&&t.pause()}),e.duration)})).catch((function(e){console.error(e)})),t}},a=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return o({type:"calling",loop:!0,duration:3e4})},s=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return o({type:"message",duration:3e3})},c=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||e)return o({type:"screenshot",duration:3e3})},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=document.querySelector("link[rel=canonical]")?document.querySelector("link[rel=canonical]").href:document.location.href,r=e.url?e.url:n;if(navigator.share)navigator.share({title:e.title?e.title:document.title,url:r}).then((function(){console.log("Thanks for sharing!")})).catch(console.error);else{var o={showCancelButton:!0,confirmButtonText:$t("misc.share_alert.confirm_btn"),cancelButtonText:$t("misc.share_alert.cancel_btn")};e.alertTitle&&(o.title=e.alertTitle),e.alertHtml?o.html=e.alertHtml:o.text=$t("misc.share_alert.text"),swtAlert.fire(o).then((function(e){e.value&&(Object(i.c)(r),setTimeout((function(){t()}),500))}))}}},bdEB:function(e,t,n){"use strict";var i=n("L2JU");function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s={props:{tag:{type:String,default:"a"},place:{type:String,default:"normal"},size:{type:String,default:"normal"},appLogo:{type:Boolean,default:!1},inline:{type:Boolean,default:!1},link:{type:String,default:""},assets:{type:Object}},data:function(){return{appLogoText:window.kmenv.name}},computed:o(o({},Object(i.c)("config",["configs","uiConfigs"])),{},{computedUrl:function(){return"a"===this.tag&&(""!==this.link?this.link:"/")},orgLogo:function(){if(this.appLogo||!this.configs.assets&&!this.assets)return"navbar"===this.place||"sidebar"===this.place||"dark"===this.place?"/images/logo-light.png":"/images/logo.png";var e=this.assets&&this.assets.logo?this.assets.logo:this.configs.assets.logo?this.configs.assets.logo:"/images/logo.png";return(this.assets&&this.assets.logoLight||this.configs.assets.logoLight)&&("navbar"===this.place&&this.uiConfigs.topNavbarLogoLight||"sidebar"===this.place&&this.uiConfigs.leftSidebarLogoLight||"dark"===this.place)&&(e=this.assets&&this.assets.logoLight?this.assets.logoLight:this.configs.assets.logoLight),e},appTitle:function(){return this.configs.basic?this.configs.basic.appName:window.kmenv.name}})},c=n("KHd+"),d=Object(c.a)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.tag,{tag:"component",class:["logo",e.place+"-logo",e.size+"-logo",e.orgLogo?"org-logo":"app-logo",e.inline?"inline-logo":""],attrs:{href:e.computedUrl}},[e.orgLogo?n("img",{staticClass:"logo-icon",attrs:{src:e.orgLogo,alt:e.appTitle}}):[n("span",{staticClass:"logo-text",attrs:{title:e.appTitle}},[e._v(e._s(e.appLogoText))])]],2)}),[],!1,null,null,null);t.a=d.exports},mpN2:function(e,t,n){var i,r,o,a;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a=function(){return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,(function(e){return r(t[a][1][e]||e)}),d,d.exports,e,t,n,i)}return n[a].exports}for(var o=!1,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,n){"use strict";var i=(0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});t.exports=i},{"./adapter_factory.js":2}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},d=i.log,l=i.detectBrowser(t),u={browserDetails:l,commonShim:c,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(l.browser){case"chrome":if(!r||!r.shimPeerConnection||!n.shimChrome)return d("Chrome shim is not included in this adapter release."),u;if(null===l.version)return d("Chrome shim can not determine version, not shimming."),u;d("adapter.js shimming chrome."),u.browserShim=r,r.shimGetUserMedia(t),r.shimMediaStream(t),r.shimPeerConnection(t),r.shimOnTrack(t),r.shimAddTrackRemoveTrack(t),r.shimGetSendersWithDtmf(t),r.shimGetStats(t),r.shimSenderReceiverGetStats(t),r.fixNegotiationNeeded(t),c.shimRTCIceCandidate(t),c.shimConnectionState(t),c.shimMaxMessageSize(t),c.shimSendThrowTypeError(t),c.removeAllowExtmapMixed(t);break;case"firefox":if(!a||!a.shimPeerConnection||!n.shimFirefox)return d("Firefox shim is not included in this adapter release."),u;d("adapter.js shimming firefox."),u.browserShim=a,a.shimGetUserMedia(t),a.shimPeerConnection(t),a.shimOnTrack(t),a.shimRemoveStream(t),a.shimSenderGetStats(t),a.shimReceiverGetStats(t),a.shimRTCDataChannel(t),a.shimAddTransceiver(t),a.shimGetParameters(t),a.shimCreateOffer(t),a.shimCreateAnswer(t),c.shimRTCIceCandidate(t),c.shimConnectionState(t),c.shimMaxMessageSize(t),c.shimSendThrowTypeError(t);break;case"edge":if(!o||!o.shimPeerConnection||!n.shimEdge)return d("MS edge shim is not included in this adapter release."),u;d("adapter.js shimming edge."),u.browserShim=o,o.shimGetUserMedia(t),o.shimGetDisplayMedia(t),o.shimPeerConnection(t),o.shimReplaceTrack(t),c.shimMaxMessageSize(t),c.shimSendThrowTypeError(t);break;case"safari":if(!s||!n.shimSafari)return d("Safari shim is not included in this adapter release."),u;d("adapter.js shimming safari."),u.browserShim=s,s.shimRTCIceServerUrls(t),s.shimCreateOfferLegacy(t),s.shimCallbacksAPI(t),s.shimLocalStreamsAPI(t),s.shimRemoteStreamsAPI(t),s.shimTrackEventTransceiver(t),s.shimGetUserMedia(t),s.shimAudioContext(t),c.shimRTCIceCandidate(t),c.shimMaxMessageSize(t),c.shimSendThrowTypeError(t),c.removeAllowExtmapMixed(t);break;default:d("Unsupported browser!")}return u};var i=d(e("./utils")),r=d(e("./chrome/chrome_shim")),o=d(e("./edge/edge_shim")),a=d(e("./firefox/firefox_shim")),s=d(e("./safari/safari_shim")),c=d(e("./common_shim"));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},r=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(i){var r=void 0;r=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===i.track.id})):{track:i.track};var o=new Event("track");o.track=i.track,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(i){var r=void 0;r=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===i.id})):{track:i};var o=new Event("track");o.track=i,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else a.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},n.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){var r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),i=n[0],r=n[1],o=n[2];if(arguments.length>0&&"function"==typeof i)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof i))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){r(s(a(e)))};return t.apply(this,[c,i])}return new Promise((function(n,i){t.apply(e,[function(e){n(s(a(e)))},i])})).then(r,o)}}},n.shimSenderReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return a.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),a.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return a.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],n=void 0,i=void 0,r=void 0;return this.getSenders().forEach((function(e){e.track===t&&(n?r=!0:n=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(i?r=!0:i=e),e.track===t})),r||n&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=d,n.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=a.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return d(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}i.apply(this,[t])};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var o=this.getSenders().find((function(e){return e.track===t}));if(o)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[n.id];if(a)a.addTrack(t),Promise.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[n.id]=s,this._reverseStreams[s.id]=n,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=c({},t,(function(){var e=this,t=arguments,i=arguments.length&&"function"==typeof arguments[0];return i?n.apply(this,[function(n){var i=l(e,n);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return l(e,t)}))}));e.RTCPeerConnection.prototype[t]=i[t]}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=u(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach((function(i){t._streams[i].getTracks().find((function(t){return e.track===t}))&&(n=t._streams[i])})),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function u(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},n.shimPeerConnection=function(e){var t=a.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){var n=0===e.RTCPeerConnection.prototype.addIceCandidate.length;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=c({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}));var i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return n||arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(e){var t=a.detectBrowser(e);a.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){var n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js"));function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var i=this.getSenders();n.apply(this,arguments);var r=this.getSenders().filter((function(e){return-1===i.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(r)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var i=t._shimmedLocalStreams[n].indexOf(e);-1!==i&&t._shimmedLocalStreams[n].splice(i,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),r.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var i=n.video&&n.video.width,r=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},i&&(n.video.mandatory.maxWidth=i),r&&(n.video.mandatory.maxHeight=r),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var n=r.detectBrowser(e),a=function(e){if("object"!==(void 0===e?"undefined":i(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal,t.optional.push(a)):(a[o("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,r){if(n.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"===i(e.video)){var c=e.video.facingMode;c=c&&("object"===(void 0===c?"undefined":i(c))?c:{ideal:c});var d=n.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||d)){delete e.video.facingMode;var l=void 0;if("environment"===c.exact||"environment"===c.ideal?l=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(l=["front"]),l)return t.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return l.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&l.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=c.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=a(e.video),o("chrome: "+JSON.stringify(e)),r(e)}))}e.video=a(e.video)}return o("chrome: "+JSON.stringify(e)),r(e)},c=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,i){s(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){i&&i(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js")),o=r.log},{"../utils.js":15}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};n.shimRTCIceCandidate=function(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),r=a.default.parseCandidate(e.candidate),o=Object.assign(n,r);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,c.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=c.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){if(!e||!e.sdp)return!1;var t=a.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=a.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n},r=function(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var r=a.default.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),a=e.sdpSemantics;"plan-b"===a&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){var c=i(arguments[0]),d=r(c),l=o(arguments[0],c),u=void 0;u=0===d&&0===l?Number.POSITIVE_INFINITY:0===d||0===l?Math.max(d,l):Math.min(d,l);var m={};Object.defineProperty(m,"maxMessageSize",{get:function(){return u}}),this._sctp=m}return s.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},c.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=c.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),n.apply(this,arguments)}}}};var r,o=e("sdp"),a=(r=o)&&r.__esModule?r:{default:r},c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var r=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}}),n.shimPeerConnection=function(e){var t=a.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,d.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,s.filterIceServers)(e.iceServers,t.version),a.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},n.shimReplaceTrack=function(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var o,a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),d=(o=c)&&o.__esModule?o:{default:o}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof t;return r&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=r?t[0]:t,!!t.length}}))};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},r=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),n.shimOnTrack=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=a.detectBrowser(e);if("object"===(void 0===e?"undefined":i(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n,i,r,o=e.RTCPeerConnection.prototype[t],a=(r=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)},(i=t)in(n={})?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,n);e.RTCPeerConnection.prototype[t]=a[t]})),t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),n=e[0],i=e[1],a=e[2];return o.apply(this,[n||null]).then((function(e){if(t.version<53&&!i)try{e.forEach((function(e){e.type=r[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(i,a)}}},n.shimSenderGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),a.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;a.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var i=t.apply(this,arguments);if(n){var r=i.sender,o=r.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===Object.keys(o.encodings[0]).length)&&(o.encodings=e.sendEncodings,r.sendEncodings=e.sendEncodings,this.setParametersPromises.push(r.setParameters(o).then((function(){delete r.sendEncodings})).catch((function(){delete r.sendEncodings}))))}return i})}},n.shimGetParameters=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}},n.shimCreateOffer=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};n.shimGetUserMedia=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":i(e))&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var d=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":i(e))&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};n.shimLocalStreamsAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(i){return t.call(n,i,e)})),e.getVideoTracks().forEach((function(i){return t.call(n,i,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=this,i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return r&&r.forEach((function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var i=e.getTracks();this.getSenders().forEach((function(e){i.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,n){var i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=c,c=function(e,t,n){var i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=c,c=function(e,t,n){var i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=c}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,i=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return i(o(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))},n.shimConstraints=o,n.shimRTCIceServerUrls=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}},n.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video")}return t.apply(this,arguments)}},n.shimAudioContext=function(e){"object"!==(void 0===e?"undefined":i(e))||e.AudioContext||(e.AudioContext=e.webkitAudioContext)};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"));function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)};n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);var o=function(e){var t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),r.apply(this,[e,o])};var o=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);var i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":i(window))){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var n=e.navigator;if(n.mozGetUserMedia)t.browser="firefox",t.version=a(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=a(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=a(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=a(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t},n.compactObject=function e(t){return c(t)?Object.keys(t).reduce((function(n,i){var r=c(t[i]),o=r?e(t[i]):t[i],a=r&&!Object.keys(o).length;return void 0===o||a?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},i,o))}),{}):t},n.walkStats=d,n.filterStats=function(e,t,n){var i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===i&&n.trackId===t.id&&d(e,n,r)}))})),r};var r=!0,o=!0;function a(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function d(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(i){i.endsWith("Id")?d(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((function(t){d(e,e.get(t),n)}))})))}},{}],16:[function(e,t,n){"use strict";var i=e("sdp");function r(e,t,n,r,o){var a=i.writeRtpDescription(e.kind,t);if(a+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(r?r.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},r=function(e,t,n,r){var o=i(e.parameters.apt,n),a=i(t.parameters.apt,r);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(i){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(i.name.toLowerCase()===a.name.toLowerCase()&&i.clockRate===a.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&a.parameters.apt&&!r(i,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(i.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var r=t.headerExtensions[i];if(e.uri===r.uri){n.headerExtensions.push(r);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n,i,r){var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=r,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(n){var r=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){r[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var r="string"==typeof i;return r&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=r?i[0]:i,!!i.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var r=this._createIceAndDtlsTransports();i.iceTransport=r.iceTransport,i.dtlsTransport=r.dtlsTransport}return t||this.transceivers.push(i),i},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var r=0;r<this.transceivers.length;r++)this.transceivers[r].track||this.transceivers[r].kind!==t.kind||(i=this.transceivers[r]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),i.getTracks().forEach((function(e){n.addTrack(e,i)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var r=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(r,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;r.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},r.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),r},l.prototype._gather=function(t,n){var r=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(r.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var d=i.writeCandidate(s);a.candidate=Object.assign(a.candidate,i.parseCandidate(d)),a.candidate.candidate=d,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=i.getMediaSections(r._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",r._localDescription.sdp=i.getDescription(r._localDescription.sdp)+l.join("");var u=r.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),c||r._dispatchEvent("icecandidate",a),u&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,r){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),r&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,r=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,r.signalingState)||r._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+r.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=i.parseRtpParameters(e);r.transceivers[t].localCapabilities=n})),r.transceivers.forEach((function(e,t){r._gather(e.mid,t)}));else if("answer"===e.type){t=i.splitSections(r._remoteDescription.sdp),n=t.shift();var s=i.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=r.transceivers[t],c=a.iceGatherer,d=a.iceTransport,l=a.dtlsTransport,u=a.localCapabilities,m=a.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length||a.rejected)){var p=i.getIceParameters(e,n),h=i.getDtlsParameters(e,n);s&&(h.role="server"),r.usingBundle&&0!==t||(r._gather(a.mid,t),"new"===d.state&&d.start(c,p,s?"controlling":"controlled"),"new"===l.state&&l.start(h));var f=o(u,m);r._transceive(a,f.codecs.length>0,!1)}}))}return r._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?r._updateSignalingState("have-local-offer"):r._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(r){var l=this;if(-1===["offer","answer"].indexOf(r.type))return Promise.reject(c("TypeError",'Unsupported type "'+r.type+'"'));if(!a("setRemoteDescription",r.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+r.type+" in state "+l.signalingState));var u={};l.remoteStreams.forEach((function(e){u[e.id]=e}));var m=[],p=i.splitSections(r.sdp),h=p.shift(),f=i.matchPrefix(h,"a=ice-lite").length>0,v=i.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=v;var g=i.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(a,c){var d=i.splitLines(a),p=i.getKind(a),g=i.isRejected(a)&&0===i.matchPrefix(a,"a=bundle-only").length,C=d[0].substr(2).split(" ")[2],b=i.getDirection(a,h),y=i.parseMsid(a),S=i.getMid(a)||i.generateIdentifier();if(g||"application"===p&&("DTLS/SCTP"===C||"UDP/DTLS/SCTP"===C))l.transceivers[c]={mid:S,kind:p,protocol:C,rejected:!0};else{var w,T,_,R,P,k,E,D,x;!g&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(p,!0));var O,M,L=i.parseRtpParameters(a);g||(O=i.getIceParameters(a,h),(M=i.getDtlsParameters(a,h)).role="client"),E=i.parseRtpEncodingParameters(a);var I=i.parseRtcpParameters(a),A=i.matchPrefix(a,"a=end-of-candidates",h).length>0,j=i.matchPrefix(a,"a=candidate:").map((function(e){return i.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===r.type||"answer"===r.type)&&!g&&v&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==r.type||g)"answer"!==r.type||g||(T=(w=l.transceivers[c]).iceGatherer,_=w.iceTransport,R=w.dtlsTransport,P=w.rtpReceiver,k=w.sendEncodingParameters,D=w.localCapabilities,l.transceivers[c].recvEncodingParameters=E,l.transceivers[c].remoteCapabilities=L,l.transceivers[c].rtcpParameters=I,j.length&&"new"===_.state&&(!f&&!A||v&&0!==c?j.forEach((function(e){s(w.iceTransport,e)})):_.setRemoteCandidates(j)),v&&0!==c||("new"===_.state&&_.start(T,O,"controlling"),"new"===R.state&&R.start(M)),!o(w.localCapabilities,w.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,l._transceive(w,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!P||"sendrecv"!==b&&"sendonly"!==b?delete w.rtpReceiver:(x=P.track,y?(u[y.stream]||(u[y.stream]=new e.MediaStream),n(x,u[y.stream]),m.push([x,P,u[y.stream]])):(u.default||(u.default=new e.MediaStream),n(x,u.default),m.push([x,P,u.default]))));else{(w=l.transceivers[c]||l._createTransceiver(p)).mid=S,w.iceGatherer||(w.iceGatherer=l._createIceGatherer(c,v)),j.length&&"new"===w.iceTransport.state&&(!A||v&&0!==c?j.forEach((function(e){s(w.iceTransport,e)})):w.iceTransport.setRemoteCandidates(j)),D=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(D.codecs=D.codecs.filter((function(e){return"rtx"!==e.name}))),k=w.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var $,U=!1;"sendrecv"===b||"sendonly"===b?(U=!w.rtpReceiver,P=w.rtpReceiver||new e.RTCRtpReceiver(w.dtlsTransport,p),U&&(x=P.track,y&&"-"===y.stream||(y?(u[y.stream]||(u[y.stream]=new e.MediaStream,Object.defineProperty(u[y.stream],"id",{get:function(){return y.stream}})),Object.defineProperty(x,"id",{get:function(){return y.track}}),$=u[y.stream]):(u.default||(u.default=new e.MediaStream),$=u.default)),$&&(n(x,$),w.associatedRemoteMediaStreams.push($)),m.push([x,P,$]))):w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===w.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),w.associatedRemoteMediaStreams=[]),w.localCapabilities=D,w.remoteCapabilities=L,w.rtpReceiver=P,w.rtcpParameters=I,w.sendEncodingParameters=k,w.recvEncodingParameters=E,l._transceive(l.transceivers[c],!1,U)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===r.type?"active":"passive"),l._remoteDescription={type:r.type,sdp:r.sdp},"offer"===r.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(u).forEach((function(t){var n=u[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",i)}))}m.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&d(l,t,i,[n])}))}})),m.forEach((function(e){e[2]||d(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var d=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(r,o){var a=r.track,s=r.kind,c=r.mid||i.generateIdentifier();r.mid=c,r.iceGatherer||(r.iceGatherer=n._createIceGatherer(o,n.usingBundle));var d=e.RTCRtpSender.getCapabilities(s);t<15019&&(d.codecs=d.codecs.filter((function(e){return"rtx"!==e.name}))),d.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=r.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new e.RTCRtpReceiver(r.dtlsTransport,s)),r.localCapabilities=d,r.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(d+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){d+=r(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+i.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=i.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,i){if(!(i+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var d=o(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=r(e,d,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(d)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(r,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){a=d;break}var l=n.transceivers[a];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return r();var u=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return r();if(u.component&&1!==u.component)return r();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!s(l.iceTransport,u))return o(c("OperationError","Can not add ICE candidate"));var m=e.candidate.trim();0===m.indexOf("a=")&&(m=m.substr(2)),(t=i.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(u.type?m:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);r()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var i;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[n]).type]||i.type,t.set(n,e[n])})),t}))}}}));var u=["createOffer","createAnswer"];return u.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:17}],17:[function(e,t,n){"use strict";var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},i.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},i.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},i.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),r=0;r<i.length;r++)n[(t=i[r].trim().split("="))[0].trim()]=t[1];return n},i.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},i.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},i.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:i.matchPrefix(e+t,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},i.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},i.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===s(e.keyParams)?i.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},i.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},i.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},i.getCryptoParameters=function(e,t){return i.matchPrefix(e+t,"a=crypto:").map(i.parseCryptoLine)},i.getIceParameters=function(e,t){var n=i.matchPrefix(e+t,"a=ice-ufrag:")[0],r=i.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&r?{usernameFragment:n.substr(12),password:r.substr(10)}:null},i.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=i.splitLines(e)[0].split(" "),r=3;r<n.length;r++){var o=n[r],a=i.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=i.parseRtpMap(a),c=i.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?i.parseFmtp(c[0]):{},s.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(i.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return i.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(i.parseExtmap(e))})),t},i.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=i.writeRtpMap(e),n+=i.writeFmtp(e),n+=i.writeRtcpFb(e)}));var r=0;return t.codecs.forEach((function(e){e.maxptime>r&&(r=e.maxptime)})),r>0&&(n+="a=maxptime:"+r+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=i.writeExtmap(e)})),n},i.parseRtpEncodingParameters=function(e){var t,n=[],r=i.parseRtpParameters(e),o=-1!==r.fecMechanisms.indexOf("RED"),a=-1!==r.fecMechanisms.indexOf("ULPFEC"),s=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,d=i.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(t=d[0][1]),r.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var i={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(i.rtx={ssrc:t}),n.push(i),o&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(i))}})),0===n.length&&c&&n.push({ssrc:c});var l=i.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},i.parseRtcpParameters=function(e){var t={},n=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var r=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=r.length>0,t.compound=0===r.length;var o=i.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},i.parseMsid=function(e){var t,n=i.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var r=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return r.length>0?{stream:(t=r[0].value.split(" "))[0],track:t[1]}:void 0},i.parseSctpDescription=function(e){var t,n=i.parseMLine(e),r=i.matchPrefix(e,"a=max-message-size:");r.length>0&&(t=parseInt(r[0].substr(19),10)),isNaN(t)&&(t=65536);var o=i.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(i.matchPrefix(e,"a=sctpmap:").length>0){var a=i.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},i.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t,n){var r=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||i.generateSessionId())+" "+r+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(e,t,n,r){var o=i.writeRtpDescription(e.kind,t);if(o+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+r.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),o},i.getDirection=function(e,t){for(var n=i.splitLines(e),r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substr(2)}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){return i.splitLines(e)[0].split(" ")[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},i.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=i.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"===s(t)&&(t.exports=i)},{}]},{},[1])(1)},"object"===s(t)&&void 0!==e?e.exports=a():(r=[],void 0===(o="function"==typeof(i=a)?i.apply(t,r):i)||(e.exports=o))}}]);
//# sourceMappingURL=live-as-guest.js.map?id=98b7a77ef551135f5404